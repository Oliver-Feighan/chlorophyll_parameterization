
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:32:18 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'k_T', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p', 'a_x', 'y_J', 'y_K']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d k_T Mg_s Mg_p Mg_d N_s N_p a_x y_J y_K --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 k_T : 0.000 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 0.8050442905656132 time/s : 3.583414
iter :    1 k_EN_s : -0.195 k_EN_p : 0.873 k_EN_d : 0.093 k_T : 0.030 Mg_s : 1.002 Mg_p : 1.018 Mg_d : 1.010 N_s : 1.017 N_p : 0.894 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 84.576 R^2(energy) : 0.001 R^2(dipole_mags) : 0.004 fitness : 0.996213235048683 time/s : 52.912212
iter :    2 k_EN_s : -3.157 k_EN_p : 17.914 k_EN_d : 0.569 k_T : 1.540 Mg_s : 1.032 Mg_p : 1.428 Mg_d : 1.184 N_s : 1.310 N_p : 1.892 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1824.584 R^2(energy) : 0.028 R^2(dipole_mags) : 0.005 fitness : 0.9945695787727956 time/s : 70.777503
iter :    3 k_EN_s : -0.102 k_EN_p : 1.702 k_EN_d : -0.648 k_T : 0.005 Mg_s : 1.015 Mg_p : 1.203 Mg_d : 1.027 N_s : 1.084 N_p : 1.368 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 83.325 R^2(energy) : 0.000 R^2(dipole_mags) : 0.011 fitness : 0.9894380874001606 time/s : 87.707154
iter :    4 k_EN_s : -6.474 k_EN_p : 50.957 k_EN_d : -17.350 k_T : 3.164 Mg_s : 1.283 Mg_p : 7.010 Mg_d : 1.882 N_s : 3.497 N_p : 14.928 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2126.539 R^2(energy) : 0.015 R^2(dipole_mags) : 0.008 fitness : 0.9922972874953842 time/s : 73.907020
iter :    5 k_EN_s : -0.182 k_EN_p : 0.042 k_EN_d : -0.144 k_T : 0.041 Mg_s : 1.007 Mg_p : 1.022 Mg_d : 1.007 N_s : 1.026 N_p : 0.984 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.472 R^2(energy) : 0.013 R^2(dipole_mags) : 0.020 fitness : 0.9795934685798455 time/s : 84.381735
iter :    6 k_EN_s : -0.072 k_EN_p : 0.017 k_EN_d : 0.000 k_T : 0.020 Mg_s : 1.015 Mg_p : 1.031 Mg_d : 1.013 N_s : 1.050 N_p : 1.034 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 0.094 R^2(energy) : 0.211 R^2(dipole_mags) : 0.164 fitness : 0.8361626616413369 time/s : 59.537734
iter :    7 k_EN_s : -0.009 k_EN_p : 0.017 k_EN_d : -0.011 k_T : 0.104 Mg_s : 1.017 Mg_p : 1.027 Mg_d : 1.019 N_s : 1.075 N_p : 0.989 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.150 R^2(energy) : 0.047 R^2(dipole_mags) : 0.220 fitness : 0.7795344550357087 time/s : 59.723426
iter :    8 k_EN_s : -0.017 k_EN_p : 0.051 k_EN_d : -0.052 k_T : 0.775 Mg_s : 1.110 Mg_p : 1.133 Mg_d : 1.130 N_s : 1.459 N_p : 0.865 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1299.892 R^2(energy) : 0.003 R^2(dipole_mags) : 0.021 fitness : 0.9785340234775942 time/s : 52.889623
iter :    9 k_EN_s : -0.104 k_EN_p : 0.354 k_EN_d : -0.455 k_T : 6.800 Mg_s : 1.922 Mg_p : 2.069 Mg_d : 2.024 N_s : 4.717 N_p : -0.280 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3526.490 R^2(energy) : 0.066 R^2(dipole_mags) : 0.002 fitness : 0.9983421495831288 time/s : 56.355605
iter :   10 k_EN_s : -0.656 k_EN_p : 2.328 k_EN_d : -3.020 k_T : 46.046 Mg_s : 7.184 Mg_p : 8.230 Mg_d : 7.870 N_s : 25.919 N_p : -7.706 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3338.035 R^2(energy) : 0.070 R^2(dipole_mags) : 0.000 fitness : 0.9995044968888874 time/s : 67.087162
iter :   11 k_EN_s : -4.471 k_EN_p : 16.017 k_EN_d : -20.804 k_T : 318.014 Mg_s : 43.661 Mg_p : 50.899 Mg_d : 48.391 N_s : 172.848 N_p : -59.173 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2829.422 R^2(energy) : 0.012 R^2(dipole_mags) : 0.000 fitness : 0.9999919362882272 time/s : 77.646625
iter :   12 k_EN_s : -35.977 k_EN_p : 129.106 k_EN_d : -167.728 k_T : 2564.869 Mg_s : 345.019 Mg_p : 403.437 Mg_d : 383.158 N_s : 1386.687 N_p : -484.375 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2530.475 R^2(energy) : 0.005 R^2(dipole_mags) : 0.022 fitness : 0.9784488293120037 time/s : 88.002697
iter :   13 k_EN_s : -596.780 k_EN_p : 2145.808 k_EN_d : -2793.240 k_T : 42670.250 Mg_s : 5722.842 Mg_p : 6672.991 Mg_d : 6357.945 N_s : 23048.920 N_p : -8077.768 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1467.767 R^2(energy) : 0.000 R^2(dipole_mags) : 0.020 fitness : 0.9798031713201243 time/s : 87.745017
iter :   14 k_EN_s : -0.624 k_EN_p : 2.228 k_EN_d : -2.888 k_T : 44.062 Mg_s : 6.912 Mg_p : 7.902 Mg_d : 7.570 N_s : 24.822 N_p : -7.333 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3323.752 R^2(energy) : 0.042 R^2(dipole_mags) : 0.000 fitness : 0.9999596823360454 time/s : 87.997119

Optimization terminated successfully.
Current function value: 1.000
Iterations: 14
Function evaluations: 272
Gradient evaluations: 14

optimized parameters: {'k_EN_s': -0.624, 'k_EN_p': 2.228, 'k_EN_d': -2.888, 'k_T': 44.062, 'Mg_s': 6.912, 'Mg_p': 7.902, 'Mg_d': 7.57, 'N_s': 24.822, 'N_p': -7.333, 'a_x': 0.5, 'y_J': 4.0, 'y_K': 2.0}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 3323.762 R^2(energy) : 0.042 R^2(dipole_mags) : 0.000 fitness : 0.9999595952651418

test set results:
RMSE(energy) : 3320.557 R^2(energy) : 0.007 R^2(dipole_mags) : 0.001 fitness : 0.999322545165407


wall-clock time : 1030.833 seconds

#######################



#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:13:06 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p', 'a_x', 'y_J', 'y_K']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 1.0
R^2 (dipole): 0.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d Mg_s Mg_p Mg_d N_s N_p a_x y_J y_K --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 1.0 0.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 0.9780466168030014 time/s : 3.621504
iter :    1 k_EN_s : 3.574 k_EN_p : 3.311 k_EN_d : 2.510 Mg_s : 1.051 Mg_p : 1.141 Mg_d : 1.205 N_s : 1.065 N_p : 0.711 a_x : 0.065 y_J : 3.998 y_K : 1.998  RMSE(energy) : 1.010 R^2(energy) : 0.009 R^2(dipole_mags) : 0.000 fitness : 0.9907123937067924 time/s : 48.671099
iter :    2 k_EN_s : 2.572 k_EN_p : -1.365 k_EN_d : 1.556 Mg_s : 1.035 Mg_p : 1.078 Mg_d : 1.095 N_s : 1.014 N_p : 0.657 a_x : 0.296 y_J : 3.987 y_K : 1.997  RMSE(energy) : 8.056 R^2(energy) : 0.010 R^2(dipole_mags) : 0.007 fitness : 0.9902072112045051 time/s : 69.861007
iter :    3 k_EN_s : 0.325 k_EN_p : 0.044 k_EN_d : -0.268 Mg_s : 1.003 Mg_p : 0.974 Mg_d : 0.919 N_s : 0.951 N_p : 0.780 a_x : 0.581 y_J : 3.980 y_K : 1.998  RMSE(energy) : 26.681 R^2(energy) : 0.068 R^2(dipole_mags) : 0.004 fitness : 0.9324648443914644 time/s : 73.163294
iter :    4 k_EN_s : 0.146 k_EN_p : 0.043 k_EN_d : -0.124 Mg_s : 1.004 Mg_p : 0.962 Mg_d : 0.904 N_s : 0.928 N_p : 0.698 a_x : 0.280 y_J : 3.980 y_K : 1.997  RMSE(energy) : 1.730 R^2(energy) : 0.049 R^2(dipole_mags) : 0.000 fitness : 0.9512122292128911 time/s : 55.794441
iter :    5 k_EN_s : 0.128 k_EN_p : 0.041 k_EN_d : -0.260 Mg_s : 1.017 Mg_p : 0.950 Mg_d : 0.802 N_s : 0.875 N_p : 0.524 a_x : 0.000 y_J : 3.967 y_K : 1.990  RMSE(energy) : 0.717 R^2(energy) : 0.006 R^2(dipole_mags) : 0.020 fitness : 0.9935911425372173 time/s : 52.307536
iter :    6 k_EN_s : -0.036 k_EN_p : 0.046 k_EN_d : 0.010 Mg_s : 1.017 Mg_p : 0.972 Mg_d : 0.845 N_s : 0.918 N_p : 0.867 a_x : 0.413 y_J : 3.975 y_K : 1.989  RMSE(energy) : 1.914 R^2(energy) : 0.014 R^2(dipole_mags) : 0.003 fitness : 0.9863548106891666 time/s : 55.544970
iter :    7 k_EN_s : -0.125 k_EN_p : 0.046 k_EN_d : 0.030 Mg_s : 1.017 Mg_p : 0.814 Mg_d : 0.579 N_s : 0.725 N_p : 1.018 a_x : 0.271 y_J : 3.956 y_K : 1.968  RMSE(energy) : 0.730 R^2(energy) : 0.045 R^2(dipole_mags) : 0.017 fitness : 0.9553013891378848 time/s : 52.313585
iter :    8 k_EN_s : 0.024 k_EN_p : 0.043 k_EN_d : -0.050 Mg_s : 1.002 Mg_p : 0.897 Mg_d : 0.772 N_s : 0.828 N_p : 0.941 a_x : 0.283 y_J : 3.977 y_K : 1.968  RMSE(energy) : 0.050 R^2(energy) : 0.318 R^2(dipole_mags) : 0.122 fitness : 0.6816077709170905 time/s : 52.410161
iter :    9 k_EN_s : -0.032 k_EN_p : 0.033 k_EN_d : -0.080 Mg_s : 0.944 Mg_p : 0.655 Mg_d : 0.520 N_s : 0.596 N_p : 1.140 a_x : 0.000 y_J : 3.974 y_K : 1.870  RMSE(energy) : 0.174 R^2(energy) : 0.049 R^2(dipole_mags) : 0.077 fitness : 0.951002024123736 time/s : 48.711830
iter :   10 k_EN_s : 0.037 k_EN_p : 0.030 k_EN_d : -0.078 Mg_s : 0.895 Mg_p : 0.580 Mg_d : 0.497 N_s : 0.796 N_p : 1.212 a_x : 0.000 y_J : 3.968 y_K : 1.849  RMSE(energy) : 0.276 R^2(energy) : 0.421 R^2(dipole_mags) : 0.127 fitness : 0.5787910026360067 time/s : 52.369564
iter :   11 k_EN_s : 0.045 k_EN_p : 0.025 k_EN_d : -0.107 Mg_s : 0.857 Mg_p : 0.478 Mg_d : 0.538 N_s : 0.878 N_p : 1.148 a_x : 0.005 y_J : 3.958 y_K : 1.805  RMSE(energy) : 0.171 R^2(energy) : 0.533 R^2(dipole_mags) : 0.074 fitness : 0.46745901978765136 time/s : 48.563486
iter :   12 k_EN_s : 0.070 k_EN_p : 0.013 k_EN_d : -0.246 Mg_s : 0.701 Mg_p : 0.607 Mg_d : 1.162 N_s : 1.588 N_p : 0.128 a_x : 0.610 y_J : 3.917 y_K : 1.573  RMSE(energy) : 13.022 R^2(energy) : 0.000 R^2(dipole_mags) : 0.001 fitness : 0.9999999727212696 time/s : 49.047121
iter :   13 k_EN_s : 0.024 k_EN_p : 0.027 k_EN_d : -0.096 Mg_s : 0.851 Mg_p : 0.478 Mg_d : 0.361 N_s : 0.961 N_p : 1.014 a_x : 0.085 y_J : 3.965 y_K : 1.744  RMSE(energy) : 0.110 R^2(energy) : 0.579 R^2(dipole_mags) : 0.149 fitness : 0.4207489967971717 time/s : 59.254506
iter :   14 k_EN_s : 0.005 k_EN_p : 0.027 k_EN_d : -0.097 Mg_s : 0.831 Mg_p : 0.547 Mg_d : 0.195 N_s : 1.021 N_p : 1.013 a_x : 0.000 y_J : 3.944 y_K : 1.631  RMSE(energy) : 0.072 R^2(energy) : 0.583 R^2(dipole_mags) : 0.159 fitness : 0.41717632463068677 time/s : 49.232110
iter :   15 k_EN_s : 0.015 k_EN_p : 0.028 k_EN_d : -0.098 Mg_s : 0.841 Mg_p : 0.493 Mg_d : 0.340 N_s : 0.981 N_p : 1.016 a_x : 0.066 y_J : 3.954 y_K : 1.636  RMSE(energy) : 0.078 R^2(energy) : 0.600 R^2(dipole_mags) : 0.150 fitness : 0.39967389459190217 time/s : 55.877645
iter :   16 k_EN_s : -0.005 k_EN_p : 0.032 k_EN_d : -0.108 Mg_s : 0.804 Mg_p : 0.483 Mg_d : 0.439 N_s : 1.024 N_p : 1.019 a_x : 0.081 y_J : 3.929 y_K : 1.164  RMSE(energy) : 0.031 R^2(energy) : 0.629 R^2(dipole_mags) : 0.150 fitness : 0.3714022668699881 time/s : 48.968542
iter :   17 k_EN_s : -0.026 k_EN_p : 0.037 k_EN_d : -0.134 Mg_s : 0.692 Mg_p : 0.530 Mg_d : 0.616 N_s : 1.074 N_p : 1.056 a_x : 0.106 y_J : 3.874 y_K : 0.000  RMSE(energy) : 0.597 R^2(energy) : 0.609 R^2(dipole_mags) : 0.131 fitness : 0.3914938911335195 time/s : 49.066379
iter :   18 k_EN_s : 0.004 k_EN_p : 0.032 k_EN_d : -0.121 Mg_s : 0.717 Mg_p : 0.529 Mg_d : 0.484 N_s : 1.019 N_p : 1.035 a_x : 0.089 y_J : 3.907 y_K : 0.683  RMSE(energy) : 0.200 R^2(energy) : 0.667 R^2(dipole_mags) : 0.157 fitness : 0.3325126092122853 time/s : 52.239903
iter :   19 k_EN_s : 0.000 k_EN_p : 0.030 k_EN_d : -0.120 Mg_s : 0.694 Mg_p : 0.547 Mg_d : 0.431 N_s : 1.038 N_p : 1.024 a_x : 0.077 y_J : 3.904 y_K : 0.698  RMSE(energy) : 0.207 R^2(energy) : 0.666 R^2(dipole_mags) : 0.154 fitness : 0.3337132664591903 time/s : 48.992486
iter :   20 k_EN_s : -0.002 k_EN_p : 0.029 k_EN_d : -0.123 Mg_s : 0.664 Mg_p : 0.563 Mg_d : 0.429 N_s : 1.052 N_p : 1.021 a_x : 0.076 y_J : 3.899 y_K : 0.604  RMSE(energy) : 0.262 R^2(energy) : 0.676 R^2(dipole_mags) : 0.162 fitness : 0.32360980115102056 time/s : 55.946770
iter :   21 k_EN_s : -0.003 k_EN_p : 0.028 k_EN_d : -0.121 Mg_s : 0.680 Mg_p : 0.569 Mg_d : 0.422 N_s : 1.051 N_p : 1.021 a_x : 0.073 y_J : 3.902 y_K : 0.719  RMSE(energy) : 0.209 R^2(energy) : 0.669 R^2(dipole_mags) : 0.155 fitness : 0.3309483616809331 time/s : 49.045538
iter :   22 k_EN_s : -0.002 k_EN_p : 0.028 k_EN_d : -0.122 Mg_s : 0.675 Mg_p : 0.577 Mg_d : 0.438 N_s : 1.044 N_p : 1.027 a_x : 0.076 y_J : 3.898 y_K : 0.661  RMSE(energy) : 0.229 R^2(energy) : 0.669 R^2(dipole_mags) : 0.155 fitness : 0.33146874321856834 time/s : 52.142215
iter :   23 k_EN_s : -0.003 k_EN_p : 0.027 k_EN_d : -0.121 Mg_s : 0.677 Mg_p : 0.597 Mg_d : 0.451 N_s : 1.038 N_p : 1.034 a_x : 0.077 y_J : 3.894 y_K : 0.674  RMSE(energy) : 0.220 R^2(energy) : 0.669 R^2(dipole_mags) : 0.156 fitness : 0.330559079433032 time/s : 52.416882
iter :   24 k_EN_s : -0.004 k_EN_p : 0.027 k_EN_d : -0.121 Mg_s : 0.681 Mg_p : 0.610 Mg_d : 0.465 N_s : 1.031 N_p : 1.039 a_x : 0.077 y_J : 3.891 y_K : 0.676  RMSE(energy) : 0.217 R^2(energy) : 0.670 R^2(dipole_mags) : 0.156 fitness : 0.3303379691274847 time/s : 56.107369
iter :   25 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.120 Mg_s : 0.682 Mg_p : 0.618 Mg_d : 0.468 N_s : 1.029 N_p : 1.039 a_x : 0.077 y_J : 3.889 y_K : 0.673  RMSE(energy) : 0.218 R^2(energy) : 0.670 R^2(dipole_mags) : 0.156 fitness : 0.3300370970864791 time/s : 55.838603
iter :   26 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.120 Mg_s : 0.687 Mg_p : 0.625 Mg_d : 0.480 N_s : 1.024 N_p : 1.042 a_x : 0.077 y_J : 3.887 y_K : 0.673  RMSE(energy) : 0.217 R^2(energy) : 0.670 R^2(dipole_mags) : 0.156 fitness : 0.3298805298855083 time/s : 55.568428
iter :   27 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.119 Mg_s : 0.690 Mg_p : 0.631 Mg_d : 0.485 N_s : 1.021 N_p : 1.043 a_x : 0.077 y_J : 3.885 y_K : 0.673  RMSE(energy) : 0.217 R^2(energy) : 0.670 R^2(dipole_mags) : 0.156 fitness : 0.32961835714325116 time/s : 56.113710
iter :   28 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.119 Mg_s : 0.692 Mg_p : 0.637 Mg_d : 0.492 N_s : 1.016 N_p : 1.044 a_x : 0.077 y_J : 3.883 y_K : 0.672  RMSE(energy) : 0.217 R^2(energy) : 0.671 R^2(dipole_mags) : 0.155 fitness : 0.3294062680783043 time/s : 55.728935
iter :   29 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.118 Mg_s : 0.698 Mg_p : 0.645 Mg_d : 0.503 N_s : 1.010 N_p : 1.046 a_x : 0.077 y_J : 3.881 y_K : 0.675  RMSE(energy) : 0.214 R^2(energy) : 0.671 R^2(dipole_mags) : 0.155 fitness : 0.32914166399272593 time/s : 55.901714
iter :   30 k_EN_s : -0.005 k_EN_p : 0.027 k_EN_d : -0.117 Mg_s : 0.699 Mg_p : 0.646 Mg_d : 0.503 N_s : 1.009 N_p : 1.045 a_x : 0.077 y_J : 3.880 y_K : 0.672  RMSE(energy) : 0.216 R^2(energy) : 0.671 R^2(dipole_mags) : 0.155 fitness : 0.3289591259051968 time/s : 55.973309

Optimization terminated successfully.
Current function value: 0.322
Iterations: 30
Function evaluations: 440
Gradient evaluations: 30

optimized parameters: {'k_EN_s': -0.003, 'k_EN_p': 0.028, 'k_EN_d': -0.122, 'Mg_s': 0.67, 'Mg_p': 0.573, 'Mg_d': 0.435, 'N_s': 1.047, 'N_p': 1.024, 'a_x': 0.075, 'y_J': 3.898, 'y_K': 0.635}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.245 R^2(energy) : 0.668 R^2(dipole_mags) : 0.154 fitness : 0.3322349716099582

test set results:
RMSE(energy) : 0.246 R^2(energy) : 0.561 R^2(dipole_mags) : 0.217 fitness : 0.43925222199320657


wall-clock time : 1665.016 seconds

#######################


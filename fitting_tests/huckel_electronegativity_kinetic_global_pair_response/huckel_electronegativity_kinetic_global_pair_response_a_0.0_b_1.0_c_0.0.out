
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 12:05:19 2021

active parameters from python argument input : ['k_s', 'k_p', 'k_d', 'k_EN_s', 'k_EN_p', 'k_EN_d', 'k_T', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p', 'a_x', 'y_J', 'y_K']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 1.0
R^2 (dipole): 0.0

recreate input with:
python optimizer.py --params k_s k_p k_d k_EN_s k_EN_p k_EN_d k_T Mg_s Mg_p Mg_d N_s N_p a_x y_J y_K --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 1.0 0.0 
making optimizer...

running optimization...

iter :    0 k_s : 2.000 k_p : 2.480 k_d : 2.270 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 k_T : 0.000 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.268 R^2(energy) : 0.022 R^2(dipole_mags) : 0.196 fitness : 0.9782764181876235 time/s : 3.719855
iter :    1 k_s : 1.986 k_p : 2.513 k_d : 2.316 k_EN_s : 3.561 k_EN_p : 3.290 k_EN_d : 2.497 k_T : 0.078 Mg_s : 1.051 Mg_p : 1.141 Mg_d : 1.203 N_s : 1.065 N_p : 0.711 a_x : 0.068 y_J : 3.998 y_K : 1.998  RMSE(energy) : 0.948 R^2(energy) : 0.007 R^2(dipole_mags) : 0.001 fitness : 0.9925748104986437 time/s : 62.818886
iter :    2 k_s : 1.924 k_p : 2.350 k_d : 2.279 k_EN_s : 1.845 k_EN_p : -1.156 k_EN_d : 0.990 k_T : 0.499 Mg_s : 1.025 Mg_p : 1.044 Mg_d : 1.042 N_s : 0.996 N_p : 0.696 a_x : 0.390 y_J : 3.985 y_K : 1.997  RMSE(energy) : 264.636 R^2(energy) : 0.003 R^2(dipole_mags) : 0.017 fitness : 0.9968585159799067 time/s : 84.305642
iter :    3 k_s : 1.954 k_p : 2.462 k_d : 2.251 k_EN_s : 0.322 k_EN_p : 0.069 k_EN_d : -0.285 k_T : 0.192 Mg_s : 1.003 Mg_p : 0.972 Mg_d : 0.916 N_s : 0.950 N_p : 0.772 a_x : 0.588 y_J : 3.979 y_K : 1.998  RMSE(energy) : 25.474 R^2(energy) : 0.057 R^2(dipole_mags) : 0.015 fitness : 0.9430839927939383 time/s : 87.602766
iter :    4 k_s : 1.946 k_p : 2.452 k_d : 2.241 k_EN_s : 0.180 k_EN_p : 0.088 k_EN_d : -0.221 k_T : 0.359 Mg_s : 1.004 Mg_p : 0.949 Mg_d : 0.876 N_s : 0.910 N_p : 0.653 a_x : 0.208 y_J : 3.975 y_K : 1.996  RMSE(energy) : 0.802 R^2(energy) : 0.023 R^2(dipole_mags) : 0.027 fitness : 0.9765869554694321 time/s : 70.250390
iter :    5 k_s : 1.840 k_p : 2.435 k_d : 2.237 k_EN_s : 0.045 k_EN_p : 0.079 k_EN_d : -0.119 k_T : 0.237 Mg_s : 1.013 Mg_p : 0.967 Mg_d : 0.859 N_s : 0.905 N_p : 0.423 a_x : 0.224 y_J : 3.954 y_K : 1.993  RMSE(energy) : 1.493 R^2(energy) : 0.001 R^2(dipole_mags) : 0.008 fitness : 0.9994781330421019 time/s : 70.163345
iter :    6 k_s : 1.947 k_p : 2.453 k_d : 2.249 k_EN_s : 0.043 k_EN_p : 0.069 k_EN_d : -0.050 k_T : 0.192 Mg_s : 1.013 Mg_p : 0.985 Mg_d : 0.910 N_s : 0.940 N_p : 0.785 a_x : 0.410 y_J : 3.964 y_K : 1.991  RMSE(energy) : 0.867 R^2(energy) : 0.253 R^2(dipole_mags) : 0.128 fitness : 0.7465538847930311 time/s : 66.915634
iter :    7 k_s : 2.014 k_p : 2.143 k_d : 2.194 k_EN_s : -0.250 k_EN_p : 0.085 k_EN_d : -0.015 k_T : 0.383 Mg_s : 1.068 Mg_p : 0.976 Mg_d : 0.683 N_s : 0.728 N_p : 0.795 a_x : 0.488 y_J : 3.832 y_K : 1.932  RMSE(energy) : 42.520 R^2(energy) : 0.098 R^2(dipole_mags) : 0.040 fitness : 0.9023730747558952 time/s : 63.005032
iter :    8 k_s : 1.720 k_p : 1.270 k_d : 2.129 k_EN_s : -0.744 k_EN_p : 0.109 k_EN_d : -0.219 k_T : 0.621 Mg_s : 1.245 Mg_p : 1.117 Mg_d : 0.475 N_s : 0.046 N_p : 1.072 a_x : 0.286 y_J : 3.534 y_K : 1.777  RMSE(energy) : 584.570 R^2(energy) : 0.022 R^2(dipole_mags) : 0.013 fitness : 0.9782763528539327 time/s : 70.208125
iter :    9 k_s : -0.223 k_p : -6.857 k_d : 1.460 k_EN_s : -6.248 k_EN_p : 0.523 k_EN_d : -0.959 k_T : 4.308 Mg_s : 2.797 Mg_p : 2.139 Mg_d : -1.791 N_s : -6.108 N_p : 3.307 a_x : 0.000 y_J : 0.784 y_K : 0.321  RMSE(energy) : 1.563 R^2(energy) : 0.039 R^2(dipole_mags) : 0.057 fitness : 0.9606400483227887 time/s : 77.519329
iter :   10 k_s : 1.698 k_p : 1.953 k_d : 2.207 k_EN_s : -0.327 k_EN_p : 0.107 k_EN_d : 0.010 k_T : 0.538 Mg_s : 1.066 Mg_p : 1.044 Mg_d : 0.773 N_s : 0.603 N_p : 1.215 a_x : 0.464 y_J : 3.782 y_K : 1.879  RMSE(energy) : 529.592 R^2(energy) : 0.036 R^2(dipole_mags) : 0.001 fitness : 0.9642697598880722 time/s : 84.183073
iter :   11 k_s : 1.910 k_p : 2.400 k_d : 2.234 k_EN_s : -0.004 k_EN_p : 0.063 k_EN_d : -0.059 k_T : 0.201 Mg_s : 1.008 Mg_p : 0.992 Mg_d : 0.849 N_s : 0.918 N_p : 0.960 a_x : 0.376 y_J : 3.913 y_K : 1.963  RMSE(energy) : 0.119 R^2(energy) : 0.341 R^2(dipole_mags) : 0.161 fitness : 0.6589355415256737 time/s : 73.450160
iter :   12 k_s : 1.903 k_p : 2.558 k_d : 2.203 k_EN_s : -0.024 k_EN_p : 0.020 k_EN_d : -0.079 k_T : 0.054 Mg_s : 0.953 Mg_p : 1.039 Mg_d : 0.741 N_s : 0.834 N_p : 1.360 a_x : 0.176 y_J : 3.794 y_K : 1.888  RMSE(energy) : 0.324 R^2(energy) : 0.040 R^2(dipole_mags) : 0.041 fitness : 0.9595725847521838 time/s : 63.136381
iter :   13 k_s : 1.937 k_p : 2.614 k_d : 2.186 k_EN_s : 0.033 k_EN_p : 0.007 k_EN_d : -0.119 k_T : -0.005 Mg_s : 0.973 Mg_p : 1.028 Mg_d : 0.664 N_s : 0.912 N_p : 1.282 a_x : 0.047 y_J : 3.801 y_K : 1.873  RMSE(energy) : 0.215 R^2(energy) : 0.293 R^2(dipole_mags) : 0.062 fitness : 0.706663840975576 time/s : 70.179089
iter :   14 k_s : 1.801 k_p : 2.789 k_d : 2.175 k_EN_s : 0.009 k_EN_p : -0.001 k_EN_d : -0.057 k_T : 0.031 Mg_s : 0.907 Mg_p : 0.944 Mg_d : 0.636 N_s : 0.711 N_p : 1.151 a_x : 0.000 y_J : 3.750 y_K : 1.807  RMSE(energy) : 0.349 R^2(energy) : 0.229 R^2(dipole_mags) : 0.052 fitness : 0.7713092210588613 time/s : 66.472383
iter :   15 k_s : 1.818 k_p : 3.007 k_d : 2.220 k_EN_s : 0.032 k_EN_p : -0.013 k_EN_d : -0.148 k_T : 0.031 Mg_s : 0.906 Mg_p : 1.032 Mg_d : 0.848 N_s : 0.854 N_p : 1.000 a_x : 0.000 y_J : 3.772 y_K : 1.775  RMSE(energy) : 0.221 R^2(energy) : 0.078 R^2(dipole_mags) : 0.035 fitness : 0.9215538388285578 time/s : 67.047558
iter :   16 k_s : 1.776 k_p : 2.948 k_d : 2.197 k_EN_s : 0.003 k_EN_p : -0.005 k_EN_d : -0.103 k_T : 0.088 Mg_s : 0.968 Mg_p : 1.115 Mg_d : 0.729 N_s : 0.907 N_p : 1.038 a_x : 0.000 y_J : 3.757 y_K : 1.718  RMSE(energy) : 0.207 R^2(energy) : 0.229 R^2(dipole_mags) : 0.077 fitness : 0.7705624450967 time/s : 66.565470
iter :   17 k_s : 1.064 k_p : 4.240 k_d : 2.219 k_EN_s : -0.220 k_EN_p : -0.044 k_EN_d : 0.135 k_T : 0.524 Mg_s : 1.370 Mg_p : 2.244 Mg_d : 0.893 N_s : 1.386 N_p : 0.260 a_x : 0.000 y_J : 3.609 y_K : 0.786  RMSE(energy) : 1.571 R^2(energy) : 0.036 R^2(dipole_mags) : 0.000 fitness : 0.9640003714866082 time/s : 66.820235
iter :   18 k_s : 1.821 k_p : 2.816 k_d : 2.200 k_EN_s : -0.000 k_EN_p : 0.011 k_EN_d : -0.086 k_T : 0.124 Mg_s : 0.944 Mg_p : 1.141 Mg_d : 0.715 N_s : 0.932 N_p : 1.008 a_x : 0.071 y_J : 3.778 y_K : 1.722  RMSE(energy) : 0.331 R^2(energy) : 0.730 R^2(dipole_mags) : 0.133 fitness : 0.26965298566186613 time/s : 70.019750
iter :   19 k_s : 1.796 k_p : 2.985 k_d : 2.195 k_EN_s : 0.007 k_EN_p : 0.001 k_EN_d : -0.067 k_T : 0.139 Mg_s : 0.878 Mg_p : 1.251 Mg_d : 0.630 N_s : 0.972 N_p : 1.006 a_x : 0.061 y_J : 3.748 y_K : 1.525  RMSE(energy) : 0.445 R^2(energy) : 0.682 R^2(dipole_mags) : 0.131 fitness : 0.3179019224765627 time/s : 62.852983
iter :   20 k_s : 1.818 k_p : 2.942 k_d : 2.206 k_EN_s : 0.004 k_EN_p : 0.007 k_EN_d : -0.072 k_T : 0.162 Mg_s : 0.902 Mg_p : 1.259 Mg_d : 0.698 N_s : 0.971 N_p : 0.978 a_x : 0.080 y_J : 3.756 y_K : 1.521  RMSE(energy) : 0.414 R^2(energy) : 0.758 R^2(dipole_mags) : 0.125 fitness : 0.24154604331048668 time/s : 66.104418
iter :   21 k_s : 1.835 k_p : 3.052 k_d : 2.217 k_EN_s : 0.004 k_EN_p : 0.005 k_EN_d : -0.061 k_T : 0.207 Mg_s : 0.863 Mg_p : 1.374 Mg_d : 0.723 N_s : 1.005 N_p : 0.938 a_x : 0.093 y_J : 3.745 y_K : 1.311  RMSE(energy) : 0.443 R^2(energy) : 0.719 R^2(dipole_mags) : 0.169 fitness : 0.28120188292974624 time/s : 63.244562
iter :   22 k_s : 1.848 k_p : 3.028 k_d : 2.214 k_EN_s : 0.005 k_EN_p : 0.005 k_EN_d : -0.064 k_T : 0.194 Mg_s : 0.858 Mg_p : 1.350 Mg_d : 0.714 N_s : 0.993 N_p : 0.952 a_x : 0.091 y_J : 3.753 y_K : 1.332  RMSE(energy) : 0.438 R^2(energy) : 0.715 R^2(dipole_mags) : 0.166 fitness : 0.28513977951507385 time/s : 70.308705
iter :   23 k_s : 1.867 k_p : 3.042 k_d : 2.214 k_EN_s : 0.005 k_EN_p : 0.005 k_EN_d : -0.064 k_T : 0.197 Mg_s : 0.834 Mg_p : 1.367 Mg_d : 0.714 N_s : 0.996 N_p : 0.949 a_x : 0.094 y_J : 3.757 y_K : 1.274  RMSE(energy) : 0.433 R^2(energy) : 0.720 R^2(dipole_mags) : 0.165 fitness : 0.28047885467424305 time/s : 69.631068
iter :   24 k_s : 1.869 k_p : 3.035 k_d : 2.214 k_EN_s : 0.005 k_EN_p : 0.005 k_EN_d : -0.065 k_T : 0.194 Mg_s : 0.817 Mg_p : 1.358 Mg_d : 0.709 N_s : 0.995 N_p : 0.952 a_x : 0.094 y_J : 3.761 y_K : 1.255  RMSE(energy) : 0.425 R^2(energy) : 0.736 R^2(dipole_mags) : 0.159 fitness : 0.26363428553377755 time/s : 73.640729
iter :   25 k_s : 1.895 k_p : 3.059 k_d : 2.212 k_EN_s : 0.004 k_EN_p : 0.004 k_EN_d : -0.064 k_T : 0.202 Mg_s : 0.776 Mg_p : 1.384 Mg_d : 0.714 N_s : 1.008 N_p : 0.943 a_x : 0.097 y_J : 3.766 y_K : 1.157  RMSE(energy) : 0.412 R^2(energy) : 0.727 R^2(dipole_mags) : 0.164 fitness : 0.2727029216927368 time/s : 73.593694
iter :   26 k_s : 1.901 k_p : 3.062 k_d : 2.212 k_EN_s : 0.003 k_EN_p : 0.004 k_EN_d : -0.064 k_T : 0.202 Mg_s : 0.750 Mg_p : 1.391 Mg_d : 0.713 N_s : 1.012 N_p : 0.942 a_x : 0.097 y_J : 3.771 y_K : 1.121  RMSE(energy) : 0.402 R^2(energy) : 0.729 R^2(dipole_mags) : 0.163 fitness : 0.27050407325513437 time/s : 73.864288
iter :   27 k_s : 1.915 k_p : 3.064 k_d : 2.212 k_EN_s : 0.002 k_EN_p : 0.004 k_EN_d : -0.063 k_T : 0.203 Mg_s : 0.724 Mg_p : 1.393 Mg_d : 0.722 N_s : 1.015 N_p : 0.941 a_x : 0.098 y_J : 3.776 y_K : 1.078  RMSE(energy) : 0.392 R^2(energy) : 0.732 R^2(dipole_mags) : 0.163 fitness : 0.2680708037104713 time/s : 73.539305
iter :   28 k_s : 1.848 k_p : 3.076 k_d : 2.266 k_EN_s : -0.003 k_EN_p : 0.003 k_EN_d : -0.058 k_T : 0.197 Mg_s : 0.710 Mg_p : 1.361 Mg_d : 0.759 N_s : 1.084 N_p : 0.926 a_x : 0.104 y_J : 3.780 y_K : 1.026  RMSE(energy) : 0.371 R^2(energy) : 0.737 R^2(dipole_mags) : 0.159 fitness : 0.2629885293005767 time/s : 80.232610
iter :   29 k_s : 1.875 k_p : 3.062 k_d : 2.336 k_EN_s : 0.002 k_EN_p : 0.004 k_EN_d : -0.063 k_T : 0.201 Mg_s : 0.726 Mg_p : 1.408 Mg_d : 0.737 N_s : 1.027 N_p : 0.942 a_x : 0.106 y_J : 3.783 y_K : 1.019  RMSE(energy) : 0.377 R^2(energy) : 0.732 R^2(dipole_mags) : 0.164 fitness : 0.26800873352393195 time/s : 80.386764
iter :   30 k_s : 1.838 k_p : 3.008 k_d : 2.222 k_EN_s : 0.004 k_EN_p : 0.006 k_EN_d : -0.069 k_T : 0.179 Mg_s : 0.773 Mg_p : 1.322 Mg_d : 0.680 N_s : 1.006 N_p : 0.956 a_x : 0.096 y_J : 3.777 y_K : 1.174  RMSE(energy) : 0.376 R^2(energy) : 0.724 R^2(dipole_mags) : 0.166 fitness : 0.27590338910218315 time/s : 80.453422

Optimization terminated successfully.
Current function value: 0.241
Iterations: 30
Function evaluations: 589
Gradient evaluations: 30

optimized parameters: {'k_s': 1.819, 'k_p': 2.947, 'k_d': 2.207, 'k_EN_s': 0.004, 'k_EN_p': 0.007, 'k_EN_d': -0.071, 'k_T': 0.164, 'Mg_s': 0.899, 'Mg_p': 1.264, 'Mg_d': 0.699, 'N_s': 0.972, 'N_p': 0.977, 'a_x': 0.081, 'y_J': 3.756, 'y_K': 1.511}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.417 R^2(energy) : 0.740 R^2(dipole_mags) : 0.118 fitness : 0.2604658661284214

test set results:
RMSE(energy) : 0.419 R^2(energy) : 0.671 R^2(dipole_mags) : 0.202 fitness : 0.32896139740788966


wall-clock time : 2193.594 seconds

#######################


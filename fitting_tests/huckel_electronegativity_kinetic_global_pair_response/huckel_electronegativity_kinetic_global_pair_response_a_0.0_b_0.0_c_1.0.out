
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 11:58:41 2021

active parameters from python argument input : ['k_s', 'k_p', 'k_d', 'k_EN_s', 'k_EN_p', 'k_EN_d', 'k_T', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p', 'a_x', 'y_J', 'y_K']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_s k_p k_d k_EN_s k_EN_p k_EN_d k_T Mg_s Mg_p Mg_d N_s N_p a_x y_J y_K --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_s : 2.000 k_p : 2.480 k_d : 2.270 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 k_T : 0.000 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.268 R^2(energy) : 0.022 R^2(dipole_mags) : 0.196 fitness : 0.8043875883334088 time/s : 3.579669
iter :    1 k_s : 1.980 k_p : 2.384 k_d : 2.271 k_EN_s : -0.194 k_EN_p : 0.839 k_EN_d : 0.090 k_T : 0.032 Mg_s : 1.001 Mg_p : 1.017 Mg_d : 1.009 N_s : 1.017 N_p : 0.902 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 87.600 R^2(energy) : 0.004 R^2(dipole_mags) : 0.000 fitness : 0.9998732825108924 time/s : 62.876560
iter :    2 k_s : 1.868 k_p : 1.778 k_d : 2.573 k_EN_s : -2.447 k_EN_p : 14.094 k_EN_d : 0.514 k_T : 1.357 Mg_s : 1.075 Mg_p : 1.520 Mg_d : 1.302 N_s : 1.390 N_p : 1.703 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1814.097 R^2(energy) : 0.034 R^2(dipole_mags) : 0.000 fitness : 0.9998544612263192 time/s : 83.935922
iter :    3 k_s : 1.233 k_p : -1.009 k_d : 3.696 k_EN_s : -12.508 k_EN_p : 74.015 k_EN_d : 2.604 k_T : 7.184 Mg_s : 1.599 Mg_p : 3.641 Mg_d : 2.539 N_s : 3.040 N_p : 5.408 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1514.725 R^2(energy) : 0.016 R^2(dipole_mags) : 0.012 fitness : 0.9884320346336825 time/s : 97.695109
iter :    4 k_s : 1.906 k_p : 2.265 k_d : 2.213 k_EN_s : -0.648 k_EN_p : 1.288 k_EN_d : -0.501 k_T : 0.437 Mg_s : 0.989 Mg_p : 1.066 Mg_d : 1.008 N_s : 1.028 N_p : 1.484 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 383.555 R^2(energy) : 0.002 R^2(dipole_mags) : 0.008 fitness : 0.992080770073988 time/s : 97.582457
iter :    5 k_s : 1.977 k_p : 2.409 k_d : 2.283 k_EN_s : -0.179 k_EN_p : 0.016 k_EN_d : -0.014 k_T : 0.070 Mg_s : 1.006 Mg_p : 1.010 Mg_d : 1.009 N_s : 1.029 N_p : 1.003 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 0.913 R^2(energy) : 0.053 R^2(dipole_mags) : 0.122 fitness : 0.8777927590694656 time/s : 76.786782
iter :    6 k_s : 1.177 k_p : -0.349 k_d : 2.888 k_EN_s : -9.654 k_EN_p : 0.122 k_EN_d : 0.642 k_T : 3.001 Mg_s : 1.045 Mg_p : 1.459 Mg_d : 1.462 N_s : 2.435 N_p : 1.758 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1534.583 R^2(energy) : 0.050 R^2(dipole_mags) : 0.008 fitness : 0.9919823644170201 time/s : 66.479362
iter :    7 k_s : 1.971 k_p : 2.361 k_d : 2.275 k_EN_s : -0.046 k_EN_p : 0.007 k_EN_d : 0.081 k_T : 0.100 Mg_s : 0.999 Mg_p : 0.998 Mg_d : 1.012 N_s : 1.067 N_p : 1.059 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.061 R^2(energy) : 0.186 R^2(dipole_mags) : 0.129 fitness : 0.8705937391319883 time/s : 83.672884
iter :    8 k_s : 1.985 k_p : 2.363 k_d : 2.277 k_EN_s : -0.041 k_EN_p : 0.009 k_EN_d : -0.000 k_T : 0.042 Mg_s : 0.983 Mg_p : 0.991 Mg_d : 1.010 N_s : 1.084 N_p : 1.022 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2.447 R^2(energy) : 0.008 R^2(dipole_mags) : 0.227 fitness : 0.7733975855851375 time/s : 66.331999
iter :    9 k_s : 1.892 k_p : 1.672 k_d : 2.308 k_EN_s : -0.065 k_EN_p : 0.011 k_EN_d : -0.028 k_T : 0.068 Mg_s : 0.842 Mg_p : 0.904 Mg_d : 1.070 N_s : 1.595 N_p : 1.185 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 0.359 R^2(energy) : 0.000 R^2(dipole_mags) : 0.131 fitness : 0.8694388890773713 time/s : 62.759941
iter :   10 k_s : 1.821 k_p : 0.924 k_d : 2.338 k_EN_s : -0.098 k_EN_p : 0.023 k_EN_d : -0.040 k_T : 0.075 Mg_s : 0.676 Mg_p : 0.850 Mg_d : 1.128 N_s : 2.112 N_p : 1.383 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 63.195 R^2(energy) : 0.000 R^2(dipole_mags) : 0.003 fitness : 0.9972193975810374 time/s : 66.731732
iter :   11 k_s : 1.815 k_p : 1.160 k_d : 2.326 k_EN_s : -0.098 k_EN_p : 0.028 k_EN_d : -0.034 k_T : 0.067 Mg_s : 0.706 Mg_p : 0.911 Mg_d : 1.099 N_s : 1.967 N_p : 1.324 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 6.251 R^2(energy) : 0.014 R^2(dipole_mags) : 0.001 fitness : 0.9985071973355152 time/s : 66.499109
iter :   12 k_s : 1.852 k_p : 1.529 k_d : 2.311 k_EN_s : -0.091 k_EN_p : 0.030 k_EN_d : -0.031 k_T : 0.079 Mg_s : 0.766 Mg_p : 0.943 Mg_d : 1.067 N_s : 1.755 N_p : 1.226 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.600 R^2(energy) : 0.025 R^2(dipole_mags) : 0.091 fitness : 0.9092768496501787 time/s : 66.297594
iter :   13 k_s : 1.847 k_p : 1.619 k_d : 2.308 k_EN_s : -0.086 k_EN_p : 0.026 k_EN_d : -0.020 k_T : 0.097 Mg_s : 0.790 Mg_p : 0.963 Mg_d : 1.050 N_s : 1.691 N_p : 1.200 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.246 R^2(energy) : 0.032 R^2(dipole_mags) : 0.225 fitness : 0.7753513041020244 time/s : 66.438572
iter :   14 k_s : 1.723 k_p : 1.458 k_d : 2.319 k_EN_s : -0.105 k_EN_p : 0.032 k_EN_d : -0.019 k_T : 0.056 Mg_s : 0.757 Mg_p : 0.975 Mg_d : 1.078 N_s : 1.840 N_p : 1.268 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.310 R^2(energy) : 0.097 R^2(dipole_mags) : 0.052 fitness : 0.9482340632243588 time/s : 66.406016
iter :   15 k_s : 1.736 k_p : 1.644 k_d : 2.313 k_EN_s : -0.099 k_EN_p : 0.030 k_EN_d : -0.015 k_T : 0.060 Mg_s : 0.795 Mg_p : 0.976 Mg_d : 1.076 N_s : 1.725 N_p : 1.221 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2.173 R^2(energy) : 0.085 R^2(dipole_mags) : 0.264 fitness : 0.7363942250328581 time/s : 66.484658
iter :   16 k_s : 0.115 k_p : 0.284 k_d : 2.525 k_EN_s : -0.421 k_EN_p : 0.146 k_EN_d : 0.028 k_T : 0.048 Mg_s : 0.487 Mg_p : 1.572 Mg_d : 1.542 N_s : 3.987 N_p : 1.768 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 15.221 R^2(energy) : 0.005 R^2(dipole_mags) : 0.005 fitness : 0.9949833924777375 time/s : 73.177642
iter :   17 k_s : 1.821 k_p : 1.650 k_d : 2.307 k_EN_s : -0.092 k_EN_p : 0.025 k_EN_d : -0.008 k_T : 0.078 Mg_s : 0.833 Mg_p : 0.962 Mg_d : 1.079 N_s : 1.647 N_p : 1.210 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.671 R^2(energy) : 0.076 R^2(dipole_mags) : 0.232 fitness : 0.7679281856095489 time/s : 76.585959
iter :   18 k_s : 1.268 k_p : 1.024 k_d : 2.419 k_EN_s : -0.219 k_EN_p : 0.060 k_EN_d : 0.079 k_T : 0.181 Mg_s : 0.788 Mg_p : 1.051 Mg_d : 1.208 N_s : 2.228 N_p : 1.443 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 202.075 R^2(energy) : 0.047 R^2(dipole_mags) : 0.000 fitness : 0.9999818181689731 time/s : 69.734188
iter :   19 k_s : 1.247 k_p : 1.084 k_d : 2.226 k_EN_s : -0.205 k_EN_p : 0.053 k_EN_d : 0.091 k_T : 0.207 Mg_s : 0.731 Mg_p : 1.096 Mg_d : 1.288 N_s : 2.136 N_p : 1.410 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 205.700 R^2(energy) : 0.029 R^2(dipole_mags) : 0.000 fitness : 0.9996694632047605 time/s : 73.077466
iter :   20 k_s : 1.757 k_p : 1.611 k_d : 2.313 k_EN_s : -0.121 k_EN_p : 0.033 k_EN_d : 0.020 k_T : 0.128 Mg_s : 0.843 Mg_p : 0.921 Mg_d : 1.134 N_s : 1.696 N_p : 1.238 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.687 R^2(energy) : 0.012 R^2(dipole_mags) : 0.081 fitness : 0.9185648992034896 time/s : 80.642374
iter :   21 k_s : -10.865 k_p : -14.074 k_d : 3.960 k_EN_s : -4.966 k_EN_p : 1.364 k_EN_d : 3.769 k_T : 6.921 Mg_s : -0.040 Mg_p : -1.552 Mg_d : 8.987 N_s : 17.402 N_p : 7.653 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1305.692 R^2(energy) : 0.042 R^2(dipole_mags) : 0.000 fitness : 0.9998458697943812 time/s : 76.788441

Optimization terminated successfully.
Current function value: 0.710
Iterations: 21
Function evaluations: 432
Gradient evaluations: 21

optimized parameters: {'k_s': 1.883, 'k_p': 1.76, 'k_d': 2.303, 'k_EN_s': -0.072, 'k_EN_p': 0.019, 'k_EN_d': -0.017, 'k_T': 0.064, 'Mg_s': 0.842, 'Mg_p': 0.95, 'Mg_d': 1.055, 'N_s': 1.548, 'N_p': 1.173, 'a_x': 0.5, 'y_J': 4.0, 'y_K': 2.0}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.444 R^2(energy) : 0.022 R^2(dipole_mags) : 0.290 fitness : 0.7102646204956755

test set results:
RMSE(energy) : 0.451 R^2(energy) : 0.031 R^2(dipole_mags) : 0.261 fitness : 0.7388718709111393


wall-clock time : 1605.856 seconds

#######################


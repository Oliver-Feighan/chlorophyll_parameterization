
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:22:04 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'k_T']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 1.0
R^2 (energy): 1.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d k_T --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 1.0 1.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 k_T : 0.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 1.5221463587657427 time/s : 3.638694
iter :    1 k_EN_s : 111.024 k_EN_p : 86.908 k_EN_d : 58.339 k_T : 2.698  RMSE(energy) : 2657.638 R^2(energy) : 0.014 R^2(dipole_mags) : 0.032 fitness : -2654.684457084078 time/s : 24.343802
iter :    2 k_EN_s : 6.407 k_EN_p : -0.790 k_EN_d : -8.803 k_T : 3.865  RMSE(energy) : 3397.932 R^2(energy) : 0.004 R^2(dipole_mags) : 0.027 fitness : -3394.9635322538147 time/s : 59.664467
iter :    3 k_EN_s : -0.772 k_EN_p : 5.400 k_EN_d : -5.681 k_T : 4.558  RMSE(energy) : 2214.682 R^2(energy) : 0.101 R^2(dipole_mags) : 0.003 fitness : -2211.7867796107653 time/s : 35.008882
iter :    4 k_EN_s : -0.028 k_EN_p : -0.122 k_EN_d : 0.343 k_T : 2.609  RMSE(energy) : 2634.536 R^2(energy) : 0.052 R^2(dipole_mags) : 0.000 fitness : -2631.588617972213 time/s : 35.238711
iter :    5 k_EN_s : 0.051 k_EN_p : 0.048 k_EN_d : -0.040 k_T : 0.185  RMSE(energy) : 0.544 R^2(energy) : 0.242 R^2(dipole_mags) : 0.213 fitness : 2.0006980095052804 time/s : 31.593796
iter :    6 k_EN_s : 0.045 k_EN_p : 0.049 k_EN_d : -0.039 k_T : 0.123  RMSE(energy) : 0.448 R^2(energy) : 0.244 R^2(dipole_mags) : 0.177 fitness : 2.1315738445062182 time/s : 24.734078
iter :    7 k_EN_s : 0.045 k_EN_p : 0.039 k_EN_d : -0.029 k_T : 0.136  RMSE(energy) : 0.425 R^2(energy) : 0.199 R^2(dipole_mags) : 0.201 fitness : 2.174411519442562 time/s : 24.294052
iter :    8 k_EN_s : 0.042 k_EN_p : 0.044 k_EN_d : -0.036 k_T : 0.146  RMSE(energy) : 0.401 R^2(energy) : 0.212 R^2(dipole_mags) : 0.199 fitness : 2.187649664887359 time/s : 28.165063
iter :    9 k_EN_s : 0.028 k_EN_p : 0.043 k_EN_d : -0.052 k_T : 0.179  RMSE(energy) : 0.120 R^2(energy) : 0.208 R^2(dipole_mags) : 0.199 fitness : 2.473334117281685 time/s : 24.761957
iter :   10 k_EN_s : -0.159 k_EN_p : 0.052 k_EN_d : -0.334 k_T : 0.513  RMSE(energy) : 278.118 R^2(energy) : 0.001 R^2(dipole_mags) : 0.001 fitness : -275.11937216550655 time/s : 24.894558
iter :   11 k_EN_s : 0.020 k_EN_p : 0.048 k_EN_d : -0.059 k_T : 0.183  RMSE(energy) : 0.142 R^2(energy) : 0.146 R^2(dipole_mags) : 0.200 fitness : 2.511757152407825 time/s : 45.444082
iter :   12 k_EN_s : 0.018 k_EN_p : 0.051 k_EN_d : -0.058 k_T : 0.180  RMSE(energy) : 0.110 R^2(energy) : 0.150 R^2(dipole_mags) : 0.178 fitness : 2.5631465611999587 time/s : 35.141266
iter :   13 k_EN_s : 0.017 k_EN_p : 0.053 k_EN_d : -0.057 k_T : 0.179  RMSE(energy) : 0.087 R^2(energy) : 0.159 R^2(dipole_mags) : 0.176 fitness : 2.5774609517986287 time/s : 38.772305
iter :   14 k_EN_s : 0.017 k_EN_p : 0.056 k_EN_d : -0.059 k_T : 0.169  RMSE(energy) : 0.080 R^2(energy) : 0.173 R^2(dipole_mags) : 0.183 fitness : 2.563464589399085 time/s : 42.219936
iter :   15 k_EN_s : 0.014 k_EN_p : 0.056 k_EN_d : -0.056 k_T : 0.177  RMSE(energy) : 0.078 R^2(energy) : 0.180 R^2(dipole_mags) : 0.179 fitness : 2.563185887796169 time/s : 41.978049
iter :   16 k_EN_s : 0.018 k_EN_p : 0.048 k_EN_d : -0.052 k_T : 0.186  RMSE(energy) : 0.077 R^2(energy) : 0.162 R^2(dipole_mags) : 0.193 fitness : 2.568652719241213 time/s : 45.605105

Optimization terminated successfully.
Current function value: 1.706
Iterations: 16
Function evaluations: 151
Gradient evaluations: 16

optimized parameters: {'k_EN_s': 0.028, 'k_EN_p': 0.043, 'k_EN_d': -0.052, 'k_T': 0.179}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.114 R^2(energy) : 0.207 R^2(dipole_mags) : 0.199 fitness : 1.7088375435687924

test set results:
RMSE(energy) : 0.113 R^2(energy) : 0.204 R^2(dipole_mags) : 0.188 fitness : 1.721533031271686


wall-clock time : 610.822 seconds

#######################


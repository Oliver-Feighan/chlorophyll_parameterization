
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 12:41:22 2021

active parameters from python argument input : ['k_s', 'k_p', 'k_d', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_s k_p k_d Mg_s Mg_p Mg_d N_s N_p --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_s : 2.000 k_p : 2.480 k_d : 2.270 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000  RMSE(energy) : 1.268 R^2(energy) : 0.022 R^2(dipole_mags) : 0.196 fitness : 0.8043875883334088 time/s : 3.569443
iter :    1 k_s : 1.980 k_p : 2.384 k_d : 2.271 Mg_s : 1.001 Mg_p : 1.017 Mg_d : 1.009 N_s : 1.017 N_p : 0.902  RMSE(energy) : 1.621 R^2(energy) : 0.119 R^2(dipole_mags) : 0.153 fitness : 0.8473956228750158 time/s : 38.856041
iter :    2 k_s : 1.964 k_p : 2.341 k_d : 2.273 Mg_s : 1.003 Mg_p : 1.022 Mg_d : 1.014 N_s : 1.031 N_p : 1.001  RMSE(energy) : 1.179 R^2(energy) : 0.030 R^2(dipole_mags) : 0.206 fitness : 0.7938021042344383 time/s : 41.668832
iter :    3 k_s : 1.771 k_p : 1.640 k_d : 2.286 Mg_s : 1.013 Mg_p : 1.131 Mg_d : 1.082 N_s : 1.174 N_p : 1.126  RMSE(energy) : 0.429 R^2(energy) : 0.032 R^2(dipole_mags) : 0.253 fitness : 0.7469264265447885 time/s : 38.641702
iter :    4 k_s : 1.875 k_p : 2.106 k_d : 2.280 Mg_s : 1.009 Mg_p : 1.059 Mg_d : 1.043 N_s : 1.093 N_p : 1.017  RMSE(energy) : 0.965 R^2(energy) : 0.058 R^2(dipole_mags) : 0.226 fitness : 0.7744320846924075 time/s : 38.666719
iter :    5 k_s : 1.720 k_p : 1.639 k_d : 2.290 Mg_s : 1.019 Mg_p : 1.127 Mg_d : 1.088 N_s : 1.183 N_p : 1.083  RMSE(energy) : 0.531 R^2(energy) : 0.056 R^2(dipole_mags) : 0.280 fitness : 0.719640073527182 time/s : 45.902133
iter :    6 k_s : 1.630 k_p : 1.589 k_d : 2.293 Mg_s : 1.027 Mg_p : 1.144 Mg_d : 1.101 N_s : 1.202 N_p : 1.084  RMSE(energy) : 0.296 R^2(energy) : 0.053 R^2(dipole_mags) : 0.241 fitness : 0.759192118560279 time/s : 38.826554
iter :    7 k_s : 0.820 k_p : 1.325 k_d : 2.326 Mg_s : 1.123 Mg_p : 1.267 Mg_d : 1.215 N_s : 1.350 N_p : 1.096  RMSE(energy) : 491.360 R^2(energy) : 0.030 R^2(dipole_mags) : 0.004 fitness : 0.9963752592258526 time/s : 42.239735
iter :    8 k_s : 0.189 k_p : 1.216 k_d : 2.338 Mg_s : 1.173 Mg_p : 1.356 Mg_d : 1.277 N_s : 1.458 N_p : 1.089  RMSE(energy) : 451.549 R^2(energy) : 0.006 R^2(dipole_mags) : 0.009 fitness : 0.9907413124001788 time/s : 42.044100
iter :    9 k_s : 1.138 k_p : 1.523 k_d : 2.325 Mg_s : 1.093 Mg_p : 1.232 Mg_d : 1.160 N_s : 1.295 N_p : 1.087  RMSE(energy) : 332.798 R^2(energy) : 0.000 R^2(dipole_mags) : 0.058 fitness : 0.9420459082624323 time/s : 45.605495
iter :   10 k_s : 1.316 k_p : 1.568 k_d : 2.308 Mg_s : 1.070 Mg_p : 1.199 Mg_d : 1.137 N_s : 1.276 N_p : 1.084  RMSE(energy) : 74.580 R^2(energy) : 0.014 R^2(dipole_mags) : 0.034 fitness : 0.9662480134400845 time/s : 42.341454
iter :   11 k_s : 1.448 k_p : 1.595 k_d : 2.301 Mg_s : 1.057 Mg_p : 1.179 Mg_d : 1.120 N_s : 1.257 N_p : 1.085  RMSE(energy) : 0.867 R^2(energy) : 0.072 R^2(dipole_mags) : 0.226 fitness : 0.7743523933284915 time/s : 42.004216
iter :   12 k_s : 1.450 k_p : 1.598 k_d : 2.301 Mg_s : 1.060 Mg_p : 1.184 Mg_d : 1.123 N_s : 1.275 N_p : 1.085  RMSE(energy) : 0.934 R^2(energy) : 0.078 R^2(dipole_mags) : 0.233 fitness : 0.7669556336890971 time/s : 42.184427
iter :   13 k_s : 1.459 k_p : 1.605 k_d : 2.302 Mg_s : 1.067 Mg_p : 1.191 Mg_d : 1.123 N_s : 1.295 N_p : 1.085  RMSE(energy) : 0.931 R^2(energy) : 0.082 R^2(dipole_mags) : 0.293 fitness : 0.7072479291096112 time/s : 42.165913
iter :   14 k_s : 1.516 k_p : 1.622 k_d : 2.298 Mg_s : 1.057 Mg_p : 1.178 Mg_d : 1.117 N_s : 1.264 N_p : 1.089  RMSE(energy) : 0.489 R^2(energy) : 0.081 R^2(dipole_mags) : 0.342 fitness : 0.6578996084187865 time/s : 38.557616
iter :   15 k_s : 1.547 k_p : 1.687 k_d : 2.293 Mg_s : 1.067 Mg_p : 1.189 Mg_d : 1.114 N_s : 1.285 N_p : 1.099  RMSE(energy) : 0.457 R^2(energy) : 0.060 R^2(dipole_mags) : 0.343 fitness : 0.6570188425007532 time/s : 38.578767
iter :   16 k_s : 1.541 k_p : 1.662 k_d : 2.294 Mg_s : 1.070 Mg_p : 1.190 Mg_d : 1.117 N_s : 1.285 N_p : 1.094  RMSE(energy) : 0.501 R^2(energy) : 0.069 R^2(dipole_mags) : 0.344 fitness : 0.6557762741537025 time/s : 38.581674
iter :   17 k_s : 1.543 k_p : 1.657 k_d : 2.294 Mg_s : 1.082 Mg_p : 1.198 Mg_d : 1.119 N_s : 1.300 N_p : 1.092  RMSE(energy) : 0.596 R^2(energy) : 0.074 R^2(dipole_mags) : 0.292 fitness : 0.7079798104813955 time/s : 38.258089
iter :   18 k_s : 1.546 k_p : 1.655 k_d : 2.293 Mg_s : 1.085 Mg_p : 1.202 Mg_d : 1.119 N_s : 1.304 N_p : 1.091  RMSE(energy) : 0.616 R^2(energy) : 0.076 R^2(dipole_mags) : 0.292 fitness : 0.7078933318464689 time/s : 42.144804
iter :   19 k_s : 1.585 k_p : 1.627 k_d : 2.294 Mg_s : 1.217 Mg_p : 1.314 Mg_d : 1.150 N_s : 1.498 N_p : 1.076  RMSE(energy) : 1.561 R^2(energy) : 0.107 R^2(dipole_mags) : 0.255 fitness : 0.7454137651120261 time/s : 42.096691
iter :   20 k_s : 1.544 k_p : 1.662 k_d : 2.295 Mg_s : 1.087 Mg_p : 1.199 Mg_d : 1.123 N_s : 1.305 N_p : 1.092  RMSE(energy) : 0.626 R^2(energy) : 0.075 R^2(dipole_mags) : 0.292 fitness : 0.7081131505158264 time/s : 49.020419
iter :   21 k_s : 1.549 k_p : 1.666 k_d : 2.284 Mg_s : 1.125 Mg_p : 1.237 Mg_d : 1.116 N_s : 1.379 N_p : 1.088  RMSE(energy) : 0.866 R^2(energy) : 0.085 R^2(dipole_mags) : 0.293 fitness : 0.7073582165037757 time/s : 45.475510
iter :   22 k_s : 1.581 k_p : 1.682 k_d : 2.205 Mg_s : 1.362 Mg_p : 1.464 Mg_d : 1.131 N_s : 1.723 N_p : 1.070  RMSE(energy) : 1.893 R^2(energy) : 0.127 R^2(dipole_mags) : 0.257 fitness : 0.7428392070195553 time/s : 45.691540
iter :   23 k_s : 1.943 k_p : 1.902 k_d : 1.484 Mg_s : 4.340 Mg_p : 4.258 Mg_d : 1.247 N_s : 6.175 N_p : 0.833  RMSE(energy) : 9.257 R^2(energy) : 0.082 R^2(dipole_mags) : 0.033 fitness : 0.9668429773931053 time/s : 48.980541
iter :   24 k_s : 1.556 k_p : 1.672 k_d : 2.242 Mg_s : 1.152 Mg_p : 1.257 Mg_d : 1.129 N_s : 1.403 N_p : 1.087  RMSE(energy) : 0.991 R^2(energy) : 0.077 R^2(dipole_mags) : 0.248 fitness : 0.7521112270543145 time/s : 56.011412
iter :   25 k_s : 1.546 k_p : 1.664 k_d : 2.293 Mg_s : 1.075 Mg_p : 1.195 Mg_d : 1.118 N_s : 1.298 N_p : 1.093  RMSE(energy) : 0.555 R^2(energy) : 0.071 R^2(dipole_mags) : 0.292 fitness : 0.7084758259952562 time/s : 49.132104
iter :   26 k_s : 1.631 k_p : 1.720 k_d : 2.255 Mg_s : 1.126 Mg_p : 1.204 Mg_d : 1.102 N_s : 1.444 N_p : 1.087  RMSE(energy) : 0.601 R^2(energy) : 0.065 R^2(dipole_mags) : 0.285 fitness : 0.714656029330675 time/s : 45.831912
iter :   27 k_s : 13.302 k_p : 9.414 k_d : -2.918 Mg_s : 8.309 Mg_p : 2.852 Mg_d : -0.890 N_s : 21.963 N_p : 0.252  RMSE(energy) : 30.574 R^2(energy) : 0.003 R^2(dipole_mags) : 0.003 fitness : 0.9967011719156411 time/s : 48.935898
iter :   28 k_s : 1.569 k_p : 1.682 k_d : 2.280 Mg_s : 1.080 Mg_p : 1.207 Mg_d : 1.109 N_s : 1.341 N_p : 1.091  RMSE(energy) : 0.564 R^2(energy) : 0.070 R^2(dipole_mags) : 0.290 fitness : 0.7096003268351887 time/s : 59.563282
iter :   29 k_s : 1.545 k_p : 1.658 k_d : 2.293 Mg_s : 1.076 Mg_p : 1.193 Mg_d : 1.114 N_s : 1.298 N_p : 1.092  RMSE(energy) : 0.532 R^2(energy) : 0.071 R^2(dipole_mags) : 0.292 fitness : 0.7081927764232993 time/s : 48.839586
iter :   30 k_s : 1.595 k_p : 1.628 k_d : 2.269 Mg_s : 1.118 Mg_p : 1.196 Mg_d : 1.059 N_s : 1.435 N_p : 1.075  RMSE(energy) : 0.435 R^2(energy) : 0.071 R^2(dipole_mags) : 0.249 fitness : 0.7510942723813038 time/s : 45.531357
iter :   31 k_s : 1.545 k_p : 1.660 k_d : 2.294 Mg_s : 1.076 Mg_p : 1.194 Mg_d : 1.114 N_s : 1.293 N_p : 1.093  RMSE(energy) : 0.526 R^2(energy) : 0.071 R^2(dipole_mags) : 0.292 fitness : 0.7083357718904595 time/s : 48.926228
iter :   32 k_s : 1.586 k_p : 1.656 k_d : 2.299 Mg_s : 1.100 Mg_p : 1.214 Mg_d : 1.071 N_s : 1.308 N_p : 1.086  RMSE(energy) : 0.389 R^2(energy) : 0.071 R^2(dipole_mags) : 0.290 fitness : 0.7100909548136389 time/s : 45.895793
iter :   33 k_s : 1.559 k_p : 1.653 k_d : 2.292 Mg_s : 1.080 Mg_p : 1.195 Mg_d : 1.102 N_s : 1.316 N_p : 1.090  RMSE(energy) : 0.501 R^2(energy) : 0.074 R^2(dipole_mags) : 0.292 fitness : 0.7084497259290119 time/s : 49.100783

Optimization terminated successfully.
Current function value: 0.656
Iterations: 33
Function evaluations: 389
Gradient evaluations: 33

optimized parameters: {'k_s': 1.542, 'k_p': 1.661, 'k_d': 2.294, 'Mg_s': 1.074, 'Mg_p': 1.193, 'Mg_d': 1.117, 'N_s': 1.291, 'N_p': 1.093}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.534 R^2(energy) : 0.071 R^2(dipole_mags) : 0.292 fitness : 0.7083258175480693

test set results:
RMSE(energy) : 0.577 R^2(energy) : 0.048 R^2(dipole_mags) : 0.270 fitness : 0.7297551612853859


wall-clock time : 1504.998 seconds

#######################


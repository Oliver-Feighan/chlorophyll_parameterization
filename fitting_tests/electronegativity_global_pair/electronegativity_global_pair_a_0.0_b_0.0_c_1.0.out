
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:13:05 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d Mg_s Mg_p Mg_d N_s N_p --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 0.8050442905656132 time/s : 3.554487
iter :    1 k_EN_s : -0.195 k_EN_p : 0.873 k_EN_d : 0.093 Mg_s : 1.002 Mg_p : 1.018 Mg_d : 1.010 N_s : 1.017 N_p : 0.894  RMSE(energy) : 85.551 R^2(energy) : 0.002 R^2(dipole_mags) : 0.005 fitness : 0.9949220377259405 time/s : 38.092951
iter :    2 k_EN_s : -2.856 k_EN_p : 16.516 k_EN_d : 0.456 Mg_s : 1.007 Mg_p : 1.454 Mg_d : 1.174 N_s : 1.266 N_p : 1.989  RMSE(energy) : 412.165 R^2(energy) : 0.003 R^2(dipole_mags) : 0.015 fitness : 0.9847122891048911 time/s : 55.911264
iter :    3 k_EN_s : 0.088 k_EN_p : 0.181 k_EN_d : -0.260 Mg_s : 1.000 Mg_p : 1.006 Mg_d : 0.981 N_s : 1.032 N_p : 0.999  RMSE(energy) : 5.664 R^2(energy) : 0.012 R^2(dipole_mags) : 0.000 fitness : 0.9996306217190397 time/s : 73.907752
iter :    4 k_EN_s : 97.534 k_EN_p : 218.324 k_EN_d : -306.104 Mg_s : 0.637 Mg_p : 9.418 Mg_d : -22.351 N_s : 40.452 N_p : 7.729  RMSE(energy) : 1326.266 R^2(energy) : 0.013 R^2(dipole_mags) : 0.029 fitness : 0.9711230233768403 time/s : 49.136571
iter :    5 k_EN_s : -0.009 k_EN_p : 0.009 k_EN_d : -0.029 Mg_s : 1.001 Mg_p : 1.020 Mg_d : 1.001 N_s : 1.019 N_p : 1.001  RMSE(energy) : 3.512 R^2(energy) : 0.000 R^2(dipole_mags) : 0.201 fitness : 0.7991693694531847 time/s : 73.311577
iter :    6 k_EN_s : 0.351 k_EN_p : -0.029 k_EN_d : 0.302 Mg_s : 1.006 Mg_p : 1.050 Mg_d : 1.007 N_s : 1.093 N_p : 0.943  RMSE(energy) : 5.695 R^2(energy) : 0.054 R^2(dipole_mags) : 0.020 fitness : 0.9802800891790059 time/s : 38.406012
iter :    7 k_EN_s : -0.006 k_EN_p : 0.008 k_EN_d : -0.019 Mg_s : 0.999 Mg_p : 1.015 Mg_d : 0.990 N_s : 1.050 N_p : 1.000  RMSE(energy) : 2.976 R^2(energy) : 0.001 R^2(dipole_mags) : 0.204 fitness : 0.7957141080974042 time/s : 48.970535
iter :    8 k_EN_s : -0.020 k_EN_p : 0.011 k_EN_d : -0.007 Mg_s : 0.990 Mg_p : 1.002 Mg_d : 0.933 N_s : 1.249 N_p : 0.999  RMSE(energy) : 2.720 R^2(energy) : 0.000 R^2(dipole_mags) : 0.210 fitness : 0.7903237456046648 time/s : 38.734920
iter :    9 k_EN_s : -0.021 k_EN_p : 0.009 k_EN_d : -0.004 Mg_s : 0.984 Mg_p : 1.009 Mg_d : 0.939 N_s : 1.298 N_p : 0.998  RMSE(energy) : 2.576 R^2(energy) : 0.000 R^2(dipole_mags) : 0.211 fitness : 0.7890490768616353 time/s : 38.609441
iter :   10 k_EN_s : -0.076 k_EN_p : -0.019 k_EN_d : 0.048 Mg_s : 0.841 Mg_p : 1.139 Mg_d : 1.016 N_s : 2.429 N_p : 0.990  RMSE(energy) : 0.914 R^2(energy) : 0.131 R^2(dipole_mags) : 0.189 fitness : 0.8114233498703728 time/s : 38.677079
iter :   11 k_EN_s : -0.035 k_EN_p : 0.005 k_EN_d : 0.002 Mg_s : 0.940 Mg_p : 1.052 Mg_d : 0.968 N_s : 1.627 N_p : 0.996  RMSE(energy) : 1.870 R^2(energy) : 0.000 R^2(dipole_mags) : 0.215 fitness : 0.7845399094727317 time/s : 41.897391
iter :   12 k_EN_s : -0.041 k_EN_p : 0.011 k_EN_d : -0.010 Mg_s : 0.910 Mg_p : 1.083 Mg_d : 1.003 N_s : 1.861 N_p : 0.997  RMSE(energy) : 1.443 R^2(energy) : 0.002 R^2(dipole_mags) : 0.219 fitness : 0.7809455975354466 time/s : 38.439189
iter :   13 k_EN_s : -0.051 k_EN_p : 0.010 k_EN_d : -0.014 Mg_s : 0.880 Mg_p : 1.112 Mg_d : 1.046 N_s : 2.117 N_p : 0.997  RMSE(energy) : 0.933 R^2(energy) : 0.021 R^2(dipole_mags) : 0.222 fitness : 0.777556094363884 time/s : 38.123869
iter :   14 k_EN_s : -0.112 k_EN_p : 0.009 k_EN_d : -0.033 Mg_s : 0.688 Mg_p : 1.275 Mg_d : 1.302 N_s : 3.679 N_p : 1.001  RMSE(energy) : 2.641 R^2(energy) : 0.000 R^2(dipole_mags) : 0.029 fitness : 0.9712617240031631 time/s : 38.361211
iter :   15 k_EN_s : -0.615 k_EN_p : -0.026 k_EN_d : -0.162 Mg_s : -0.850 Mg_p : 2.507 Mg_d : 3.385 N_s : 16.107 N_p : 1.033  RMSE(energy) : 80.272 R^2(energy) : 0.000 R^2(dipole_mags) : 0.003 fitness : 0.9969755729821648 time/s : 42.080557
iter :   16 k_EN_s : -0.121 k_EN_p : 0.005 k_EN_d : -0.008 Mg_s : 0.656 Mg_p : 1.242 Mg_d : 1.286 N_s : 3.849 N_p : 1.001  RMSE(energy) : 1.980 R^2(energy) : 0.030 R^2(dipole_mags) : 0.009 fitness : 0.9909535615528274 time/s : 48.850108
iter :   17 k_EN_s : -0.078 k_EN_p : 0.007 k_EN_d : -0.010 Mg_s : 0.799 Mg_p : 1.150 Mg_d : 1.158 N_s : 2.747 N_p : 1.000  RMSE(energy) : 0.541 R^2(energy) : 0.236 R^2(dipole_mags) : 0.207 fitness : 0.7934237589072248 time/s : 45.557238
iter :   18 k_EN_s : -0.257 k_EN_p : -0.015 k_EN_d : 0.045 Mg_s : 0.210 Mg_p : 1.197 Mg_d : 1.914 N_s : 6.929 N_p : 1.031  RMSE(energy) : 1.823 R^2(energy) : 0.020 R^2(dipole_mags) : 0.007 fitness : 0.9934568953189032 time/s : 45.377520
iter :   19 k_EN_s : -0.075 k_EN_p : 0.007 k_EN_d : -0.008 Mg_s : 0.803 Mg_p : 1.123 Mg_d : 1.138 N_s : 2.675 N_p : 1.002  RMSE(energy) : 0.341 R^2(energy) : 0.215 R^2(dipole_mags) : 0.207 fitness : 0.7928108184705281 time/s : 48.817385
iter :   20 k_EN_s : -0.812 k_EN_p : -0.127 k_EN_d : 0.338 Mg_s : -1.361 Mg_p : 1.019 Mg_d : 3.847 N_s : 18.754 N_p : 1.156  RMSE(energy) : 124.638 R^2(energy) : 0.049 R^2(dipole_mags) : 0.045 fitness : 0.9552988105528112 time/s : 49.203926
iter :   21 k_EN_s : -0.061 k_EN_p : 0.009 k_EN_d : -0.014 Mg_s : 0.854 Mg_p : 1.126 Mg_d : 1.107 N_s : 2.349 N_p : 0.999  RMSE(energy) : 0.404 R^2(energy) : 0.080 R^2(dipole_mags) : 0.227 fitness : 0.7727686448213917 time/s : 59.377157
iter :   22 k_EN_s : -0.081 k_EN_p : -0.004 k_EN_d : -0.000 Mg_s : 0.793 Mg_p : 1.064 Mg_d : 1.373 N_s : 2.516 N_p : 1.014  RMSE(energy) : 0.975 R^2(energy) : 0.222 R^2(dipole_mags) : 0.182 fitness : 0.8181633401817039 time/s : 45.622837
iter :   23 k_EN_s : -0.130 k_EN_p : -0.038 k_EN_d : 0.032 Mg_s : 0.743 Mg_p : 0.826 Mg_d : 2.207 N_s : 2.817 N_p : 1.061  RMSE(energy) : 3.787 R^2(energy) : 0.042 R^2(dipole_mags) : 0.031 fitness : 0.9687078065661403 time/s : 52.333209
iter :   24 k_EN_s : -1.046 k_EN_p : -0.669 k_EN_d : 0.628 Mg_s : -1.078 Mg_p : -3.313 Mg_d : 17.563 N_s : 9.115 N_p : 1.912  RMSE(energy) : 39.911 R^2(energy) : 0.002 R^2(dipole_mags) : 0.001 fitness : 0.9989581690696892 time/s : 55.840273
iter :   25 k_EN_s : -0.167 k_EN_p : -0.056 k_EN_d : 0.052 Mg_s : 0.728 Mg_p : 0.529 Mg_d : 2.785 N_s : 3.181 N_p : 1.102  RMSE(energy) : 4.023 R^2(energy) : 0.039 R^2(dipole_mags) : 0.002 fitness : 0.9979824001467923 time/s : 66.791306
iter :   26 k_EN_s : -0.077 k_EN_p : 0.001 k_EN_d : -0.004 Mg_s : 0.833 Mg_p : 1.042 Mg_d : 1.340 N_s : 2.471 N_p : 1.014  RMSE(energy) : 0.660 R^2(energy) : 0.229 R^2(dipole_mags) : 0.187 fitness : 0.8130458325107546 time/s : 49.186892
iter :   27 k_EN_s : -0.074 k_EN_p : 0.004 k_EN_d : -0.005 Mg_s : 0.847 Mg_p : 1.060 Mg_d : 1.279 N_s : 2.456 N_p : 1.011  RMSE(energy) : 0.440 R^2(energy) : 0.200 R^2(dipole_mags) : 0.196 fitness : 0.8036869931317093 time/s : 48.892418
iter :   28 k_EN_s : -0.208 k_EN_p : -0.044 k_EN_d : 0.085 Mg_s : 0.889 Mg_p : 0.356 Mg_d : 2.947 N_s : 3.603 N_p : 1.127  RMSE(energy) : 3.648 R^2(energy) : 0.021 R^2(dipole_mags) : 0.015 fitness : 0.9852607922453994 time/s : 49.151546
iter :   29 k_EN_s : -1.387 k_EN_p : -0.464 k_EN_d : 0.836 Mg_s : 1.084 Mg_p : -5.907 Mg_d : 18.255 N_s : 13.672 N_p : 2.173  RMSE(energy) : 18.405 R^2(energy) : 0.007 R^2(dipole_mags) : 0.003 fitness : 0.997340529554 time/s : 52.279843

Optimization terminated successfully.
Current function value: 0.771
Iterations: 29
Function evaluations: 383
Gradient evaluations: 29

optimized parameters: {'k_EN_s': -0.061, 'k_EN_p': 0.009, 'k_EN_d': -0.015, 'Mg_s': 0.851, 'Mg_p': 1.128, 'Mg_d': 1.099, 'N_s': 2.351, 'N_p': 0.999}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.404 R^2(energy) : 0.077 R^2(dipole_mags) : 0.227 fitness : 0.7730732240142892

test set results:
RMSE(energy) : 0.399 R^2(energy) : 0.094 R^2(dipole_mags) : 0.216 fitness : 0.7839425002888193


wall-clock time : 1465.281 seconds

#######################


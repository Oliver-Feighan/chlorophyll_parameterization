
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:13:06 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 1.0
R^2 (energy): 1.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d Mg_s Mg_p Mg_d N_s N_p --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 1.0 1.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 1.5221463587657427 time/s : 4.161504
iter :    1 k_EN_s : 111.024 k_EN_p : 86.908 k_EN_d : 58.339 Mg_s : 2.630 Mg_p : 4.624 Mg_d : 5.618 N_s : 5.123 N_p : 4.626  RMSE(energy) : 1517.571 R^2(energy) : 0.030 R^2(dipole_mags) : 0.057 fitness : -1514.657824537302 time/s : 38.343978
iter :    2 k_EN_s : 6.997 k_EN_p : -0.936 k_EN_d : -9.138 Mg_s : 1.172 Mg_p : 0.882 Mg_d : -0.030 N_s : 1.979 N_p : 7.705  RMSE(energy) : 43.140 R^2(energy) : 0.001 R^2(dipole_mags) : 0.001 fitness : -40.14154362745766 time/s : 73.352697
iter :    3 k_EN_s : -1.049 k_EN_p : 5.963 k_EN_d : -5.505 Mg_s : 1.122 Mg_p : 0.601 Mg_d : -0.538 N_s : 1.889 N_p : 10.665  RMSE(energy) : 438.958 R^2(energy) : 0.000 R^2(dipole_mags) : 0.008 fitness : -435.96591953783826 time/s : 56.013430
iter :    4 k_EN_s : 0.067 k_EN_p : -0.920 k_EN_d : 1.522 Mg_s : 1.133 Mg_p : 0.916 Mg_d : 0.325 N_s : 1.985 N_p : 7.911  RMSE(energy) : 54.863 R^2(energy) : 0.005 R^2(dipole_mags) : 0.011 fitness : -51.8795659503854 time/s : 48.920739
iter :    5 k_EN_s : 0.089 k_EN_p : 0.028 k_EN_d : -0.051 Mg_s : 1.004 Mg_p : 1.023 Mg_d : 0.925 N_s : 1.033 N_p : 1.179  RMSE(energy) : 0.114 R^2(energy) : 0.121 R^2(dipole_mags) : 0.185 fitness : 2.58135125497741 time/s : 52.599792
iter :    6 k_EN_s : 0.069 k_EN_p : 0.052 k_EN_d : -0.081 Mg_s : 0.992 Mg_p : 1.182 Mg_d : 1.029 N_s : 1.252 N_p : 1.126  RMSE(energy) : 0.204 R^2(energy) : 0.081 R^2(dipole_mags) : 0.011 fitness : 2.7042376848365826 time/s : 38.391057
iter :    7 k_EN_s : 0.083 k_EN_p : 0.034 k_EN_d : -0.059 Mg_s : 0.976 Mg_p : 1.075 Mg_d : 1.016 N_s : 1.108 N_p : 1.192  RMSE(energy) : 0.087 R^2(energy) : 0.134 R^2(dipole_mags) : 0.171 fitness : 2.6079968385735848 time/s : 41.783901
iter :    8 k_EN_s : 0.085 k_EN_p : 0.033 k_EN_d : -0.061 Mg_s : 0.976 Mg_p : 1.083 Mg_d : 1.000 N_s : 1.103 N_p : 1.182  RMSE(energy) : 0.079 R^2(energy) : 0.142 R^2(dipole_mags) : 0.173 fitness : 2.6070604204794203 time/s : 38.271619
iter :    9 k_EN_s : 0.086 k_EN_p : 0.032 k_EN_d : -0.062 Mg_s : 0.960 Mg_p : 1.094 Mg_d : 1.013 N_s : 1.115 N_p : 1.184  RMSE(energy) : 0.078 R^2(energy) : 0.143 R^2(dipole_mags) : 0.175 fitness : 2.6041626630525014 time/s : 38.168077
iter :   10 k_EN_s : 0.095 k_EN_p : 0.031 k_EN_d : -0.079 Mg_s : 0.804 Mg_p : 1.200 Mg_d : 1.146 N_s : 1.243 N_p : 1.204  RMSE(energy) : 0.133 R^2(energy) : 0.173 R^2(dipole_mags) : 0.166 fitness : 2.5269467534372705 time/s : 38.167901
iter :   11 k_EN_s : 0.158 k_EN_p : 0.025 k_EN_d : -0.197 Mg_s : -0.121 Mg_p : 1.855 Mg_d : 1.983 N_s : 2.025 N_p : 1.375  RMSE(energy) : 2.581 R^2(energy) : 0.087 R^2(dipole_mags) : 0.041 fitness : 0.29100794005767516 time/s : 41.970973
iter :   12 k_EN_s : 0.103 k_EN_p : 0.032 k_EN_d : -0.089 Mg_s : 0.707 Mg_p : 1.261 Mg_d : 1.169 N_s : 1.342 N_p : 1.230  RMSE(energy) : 0.203 R^2(energy) : 0.194 R^2(dipole_mags) : 0.165 fitness : 2.438960398749246 time/s : 45.112507
iter :   13 k_EN_s : 0.104 k_EN_p : 0.031 k_EN_d : -0.090 Mg_s : 0.759 Mg_p : 1.313 Mg_d : 1.138 N_s : 1.382 N_p : 1.237  RMSE(energy) : 0.185 R^2(energy) : 0.196 R^2(dipole_mags) : 0.166 fitness : 2.4523466495126693 time/s : 48.710154
iter :   14 k_EN_s : 0.159 k_EN_p : 0.029 k_EN_d : -0.148 Mg_s : 0.019 Mg_p : 1.709 Mg_d : 1.209 N_s : 2.201 N_p : 1.350  RMSE(energy) : 1.434 R^2(energy) : 0.057 R^2(dipole_mags) : 0.053 fitness : 1.4560462676832744 time/s : 52.281790
iter :   15 k_EN_s : 0.233 k_EN_p : 0.024 k_EN_d : -0.245 Mg_s : -0.883 Mg_p : 2.365 Mg_d : 1.602 N_s : 3.045 N_p : 1.590  RMSE(energy) : 0.917 R^2(energy) : 0.077 R^2(dipole_mags) : 0.027 fitness : 1.9802974989579005 time/s : 55.399759
iter :   16 k_EN_s : 0.101 k_EN_p : 0.031 k_EN_d : -0.080 Mg_s : 0.773 Mg_p : 1.212 Mg_d : 1.090 N_s : 1.271 N_p : 1.227  RMSE(energy) : 0.089 R^2(energy) : 0.171 R^2(dipole_mags) : 0.168 fitness : 2.57134220140743 time/s : 55.733571
iter :   17 k_EN_s : 0.524 k_EN_p : -0.002 k_EN_d : -0.499 Mg_s : -4.192 Mg_p : 4.767 Mg_d : 1.657 N_s : 4.838 N_p : 2.503  RMSE(energy) : 1.281 R^2(energy) : 0.001 R^2(dipole_mags) : 0.011 fitness : 1.707389303964994 time/s : 52.103372
iter :   18 k_EN_s : 0.122 k_EN_p : 0.029 k_EN_d : -0.106 Mg_s : 0.507 Mg_p : 1.401 Mg_d : 1.127 N_s : 1.527 N_p : 1.293  RMSE(energy) : 0.332 R^2(energy) : 0.198 R^2(dipole_mags) : 0.157 fitness : 2.31288843913353 time/s : 59.306170
iter :   19 k_EN_s : 0.875 k_EN_p : -0.026 k_EN_d : -1.016 Mg_s : -8.693 Mg_p : 8.173 Mg_d : 2.352 N_s : 10.971 N_p : 3.577  RMSE(energy) : 4.055 R^2(energy) : 0.027 R^2(dipole_mags) : 0.001 fitness : -1.0831490975594518 time/s : 52.294937
iter :   20 k_EN_s : 0.095 k_EN_p : 0.032 k_EN_d : -0.076 Mg_s : 0.823 Mg_p : 1.177 Mg_d : 1.088 N_s : 1.226 N_p : 1.213  RMSE(energy) : 0.079 R^2(energy) : 0.155 R^2(dipole_mags) : 0.168 fitness : 2.5979646573075663 time/s : 59.243701
iter :   21 k_EN_s : 0.187 k_EN_p : 0.026 k_EN_d : -0.178 Mg_s : -0.242 Mg_p : 1.846 Mg_d : 1.211 N_s : 2.112 N_p : 1.519  RMSE(energy) : 0.890 R^2(energy) : 0.001 R^2(dipole_mags) : 0.009 fitness : 2.0996639718755206 time/s : 52.412266
iter :   22 k_EN_s : 0.092 k_EN_p : 0.031 k_EN_d : -0.071 Mg_s : 0.884 Mg_p : 1.148 Mg_d : 1.068 N_s : 1.184 N_p : 1.202  RMSE(energy) : 0.078 R^2(energy) : 0.152 R^2(dipole_mags) : 0.176 fitness : 2.5935479119435234 time/s : 59.576346
iter :   23 k_EN_s : 0.104 k_EN_p : 0.030 k_EN_d : -0.080 Mg_s : 0.836 Mg_p : 1.187 Mg_d : 1.064 N_s : 1.255 N_p : 1.237  RMSE(energy) : 0.082 R^2(energy) : 0.165 R^2(dipole_mags) : 0.170 fitness : 2.582587477379622 time/s : 48.944169
iter :   24 k_EN_s : 0.267 k_EN_p : 0.010 k_EN_d : -0.194 Mg_s : 0.313 Mg_p : 1.733 Mg_d : 0.882 N_s : 2.299 N_p : 1.690  RMSE(energy) : 1.041 R^2(energy) : 0.009 R^2(dipole_mags) : 0.010 fitness : 1.9391753086462364 time/s : 58.826026
iter :   25 k_EN_s : 0.092 k_EN_p : 0.032 k_EN_d : -0.072 Mg_s : 0.877 Mg_p : 1.148 Mg_d : 1.077 N_s : 1.181 N_p : 1.203  RMSE(energy) : 0.078 R^2(energy) : 0.157 R^2(dipole_mags) : 0.166 fitness : 2.599548788460464 time/s : 62.155994
iter :   26 k_EN_s : 0.098 k_EN_p : 0.032 k_EN_d : -0.075 Mg_s : 0.871 Mg_p : 1.148 Mg_d : 1.059 N_s : 1.187 N_p : 1.221  RMSE(energy) : 0.076 R^2(energy) : 0.145 R^2(dipole_mags) : 0.178 fitness : 2.6004982009622784 time/s : 52.529450
iter :   27 k_EN_s : 0.680 k_EN_p : 0.012 k_EN_d : -0.454 Mg_s : -0.514 Mg_p : 1.621 Mg_d : 0.292 N_s : 2.479 N_p : 3.037  RMSE(energy) : 4.225 R^2(energy) : 0.001 R^2(dipole_mags) : 0.000 fitness : -1.2268417954577338 time/s : 55.738412
iter :   28 k_EN_s : 0.110 k_EN_p : 0.032 k_EN_d : -0.083 Mg_s : 0.838 Mg_p : 1.157 Mg_d : 1.045 N_s : 1.221 N_p : 1.260  RMSE(energy) : 0.083 R^2(energy) : 0.169 R^2(dipole_mags) : 0.175 fitness : 2.57260873612923 time/s : 45.320362
iter :   29 k_EN_s : 0.112 k_EN_p : 0.032 k_EN_d : -0.087 Mg_s : 0.812 Mg_p : 1.160 Mg_d : 1.049 N_s : 1.241 N_p : 1.274  RMSE(energy) : 0.084 R^2(energy) : 0.175 R^2(dipole_mags) : 0.173 fitness : 2.568721069294697 time/s : 38.420160
iter :   30 k_EN_s : 0.115 k_EN_p : 0.034 k_EN_d : -0.095 Mg_s : 0.741 Mg_p : 1.163 Mg_d : 1.071 N_s : 1.295 N_p : 1.304  RMSE(energy) : 0.088 R^2(energy) : 0.184 R^2(dipole_mags) : 0.162 fitness : 2.5661601608487588 time/s : 38.362838
iter :   31 k_EN_s : 0.115 k_EN_p : 0.036 k_EN_d : -0.109 Mg_s : 0.602 Mg_p : 1.162 Mg_d : 1.131 N_s : 1.397 N_p : 1.349  RMSE(energy) : 0.109 R^2(energy) : 0.219 R^2(dipole_mags) : 0.145 fitness : 2.5259450855697603 time/s : 45.128489
iter :   32 k_EN_s : 0.110 k_EN_p : 0.036 k_EN_d : -0.103 Mg_s : 0.647 Mg_p : 1.155 Mg_d : 1.125 N_s : 1.364 N_p : 1.324  RMSE(energy) : 0.094 R^2(energy) : 0.203 R^2(dipole_mags) : 0.155 fitness : 2.547307892565694 time/s : 52.169064
iter :   33 k_EN_s : 0.106 k_EN_p : 0.045 k_EN_d : -0.164 Mg_s : -0.003 Mg_p : 1.141 Mg_d : 1.421 N_s : 1.828 N_p : 1.521  RMSE(energy) : 0.244 R^2(energy) : 0.139 R^2(dipole_mags) : 0.067 fitness : 2.550031459410701 time/s : 52.270429
iter :   34 k_EN_s : 0.109 k_EN_p : 0.033 k_EN_d : -0.089 Mg_s : 0.780 Mg_p : 1.157 Mg_d : 1.068 N_s : 1.265 N_p : 1.280  RMSE(energy) : 0.078 R^2(energy) : 0.178 R^2(dipole_mags) : 0.165 fitness : 2.5797007000756107 time/s : 55.658401
iter :   35 k_EN_s : 0.100 k_EN_p : 0.036 k_EN_d : -0.106 Mg_s : 0.592 Mg_p : 1.136 Mg_d : 1.174 N_s : 1.404 N_p : 1.328  RMSE(energy) : 0.139 R^2(energy) : 0.240 R^2(dipole_mags) : 0.138 fitness : 2.483274738948675 time/s : 41.651535
iter :   36 k_EN_s : 0.056 k_EN_p : 0.051 k_EN_d : -0.192 Mg_s : -0.386 Mg_p : 1.026 Mg_d : 1.718 N_s : 2.139 N_p : 1.586  RMSE(energy) : 2.407 R^2(energy) : 0.026 R^2(dipole_mags) : 0.015 fitness : 0.5516249474319734 time/s : 52.629256

Optimization terminated successfully.
Current function value: 1.733
Iterations: 36
Function evaluations: 488
Gradient evaluations: 36

optimized parameters: {'k_EN_s': 0.111, 'k_EN_p': 0.033, 'k_EN_d': -0.088, 'Mg_s': 0.795, 'Mg_p': 1.159, 'Mg_d': 1.059, 'N_s': 1.254, 'N_p': 1.278}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.083 R^2(energy) : 0.177 R^2(dipole_mags) : 0.171 fitness : 1.7345224393958543

test set results:
RMSE(energy) : 0.114 R^2(energy) : 0.111 R^2(dipole_mags) : 0.219 fitness : 1.7837688824720908


wall-clock time : 1850.628 seconds

#######################



#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:31:36 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d', 'k_T', 'Mg_s', 'Mg_p', 'Mg_d', 'N_s', 'N_p']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 1.0
R^2 (energy): 1.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d k_T Mg_s Mg_p Mg_d N_s N_p --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 1.0 1.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 k_T : 0.000 Mg_s : 1.000 Mg_p : 1.000 Mg_d : 1.000 N_s : 1.000 N_p : 1.000  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 1.5221463587657427 time/s : 3.489055
iter :    1 k_EN_s : 111.024 k_EN_p : 86.908 k_EN_d : 58.339 k_T : 2.698 Mg_s : 2.630 Mg_p : 4.624 Mg_d : 5.618 N_s : 5.123 N_p : 4.626  RMSE(energy) : 2661.095 R^2(energy) : 0.012 R^2(dipole_mags) : 0.013 fitness : -2658.1187788008565 time/s : 41.192857
iter :    2 k_EN_s : 6.486 k_EN_p : -0.696 k_EN_d : -8.787 k_T : 3.878 Mg_s : 1.159 Mg_p : 0.831 Mg_d : -0.011 N_s : 1.899 N_p : 7.025  RMSE(energy) : 3394.392 R^2(energy) : 0.006 R^2(dipole_mags) : 0.002 fitness : -3391.399820529663 time/s : 75.873659
iter :    3 k_EN_s : -1.467 k_EN_p : 6.203 k_EN_d : -5.253 k_T : 4.900 Mg_s : 1.107 Mg_p : 0.593 Mg_d : -0.311 N_s : 1.774 N_p : 9.266  RMSE(energy) : 1830.242 R^2(energy) : 0.053 R^2(dipole_mags) : 0.002 fitness : -1827.2971050486751 time/s : 51.929122
iter :    4 k_EN_s : -0.060 k_EN_p : -0.881 k_EN_d : 1.470 k_T : 1.848 Mg_s : 1.100 Mg_p : 1.079 Mg_d : 0.923 N_s : 1.882 N_p : 4.939  RMSE(energy) : 1167.665 R^2(energy) : 0.009 R^2(dipole_mags) : 0.003 fitness : -1164.6772801964605 time/s : 52.293095
iter :    5 k_EN_s : 0.023 k_EN_p : 0.064 k_EN_d : -0.081 k_T : 0.119 Mg_s : 1.010 Mg_p : 1.312 Mg_d : 1.389 N_s : 1.575 N_p : 1.238  RMSE(energy) : 0.258 R^2(energy) : 0.080 R^2(dipole_mags) : 0.004 fitness : 2.658762573444366 time/s : 52.164504
iter :    6 k_EN_s : 0.024 k_EN_p : 0.039 k_EN_d : -0.035 k_T : 0.708 Mg_s : 1.009 Mg_p : 1.239 Mg_d : 1.267 N_s : 1.459 N_p : 0.872  RMSE(energy) : 840.609 R^2(energy) : 0.017 R^2(dipole_mags) : 0.000 fitness : -837.6257957312673 time/s : 48.584444
iter :    7 k_EN_s : -0.140 k_EN_p : 0.080 k_EN_d : 0.005 k_T : 2.742 Mg_s : 0.993 Mg_p : 1.875 Mg_d : 2.182 N_s : 2.769 N_p : 0.022  RMSE(energy) : 3602.655 R^2(energy) : 0.082 R^2(dipole_mags) : 0.019 fitness : -3599.756817297263 time/s : 45.103883
iter :    8 k_EN_s : 0.057 k_EN_p : 0.036 k_EN_d : -0.046 k_T : 0.157 Mg_s : 1.007 Mg_p : 1.069 Mg_d : 1.058 N_s : 1.194 N_p : 1.089  RMSE(energy) : 0.085 R^2(energy) : 0.200 R^2(dipole_mags) : 0.206 fitness : 2.5084898385587557 time/s : 55.645061
iter :    9 k_EN_s : 0.051 k_EN_p : 0.045 k_EN_d : -0.052 k_T : 0.145 Mg_s : 1.018 Mg_p : 1.057 Mg_d : 1.078 N_s : 1.209 N_p : 1.067  RMSE(energy) : 0.107 R^2(energy) : 0.225 R^2(dipole_mags) : 0.199 fitness : 2.469176601671989 time/s : 41.568556
iter :   10 k_EN_s : 0.053 k_EN_p : 0.044 k_EN_d : -0.051 k_T : 0.141 Mg_s : 1.015 Mg_p : 1.038 Mg_d : 1.118 N_s : 1.151 N_p : 1.081  RMSE(energy) : 0.087 R^2(energy) : 0.218 R^2(dipole_mags) : 0.200 fitness : 2.4952352769694515 time/s : 48.587090
iter :   11 k_EN_s : 0.052 k_EN_p : 0.044 k_EN_d : -0.050 k_T : 0.141 Mg_s : 1.018 Mg_p : 1.019 Mg_d : 1.161 N_s : 1.115 N_p : 1.083  RMSE(energy) : 0.082 R^2(energy) : 0.219 R^2(dipole_mags) : 0.199 fitness : 2.5005683783025936 time/s : 41.548190
iter :   12 k_EN_s : 0.049 k_EN_p : 0.047 k_EN_d : -0.050 k_T : 0.149 Mg_s : 1.036 Mg_p : 0.968 Mg_d : 1.282 N_s : 1.048 N_p : 1.085  RMSE(energy) : 0.092 R^2(energy) : 0.274 R^2(dipole_mags) : 0.199 fitness : 2.435820702756498 time/s : 41.765079
iter :   13 k_EN_s : 0.048 k_EN_p : 0.046 k_EN_d : -0.048 k_T : 0.163 Mg_s : 1.071 Mg_p : 0.906 Mg_d : 1.408 N_s : 1.015 N_p : 1.098  RMSE(energy) : 0.081 R^2(energy) : 0.270 R^2(dipole_mags) : 0.205 fitness : 2.443869413691003 time/s : 41.665869
iter :   14 k_EN_s : 0.044 k_EN_p : 0.049 k_EN_d : -0.050 k_T : 0.172 Mg_s : 1.113 Mg_p : 0.846 Mg_d : 1.504 N_s : 1.011 N_p : 1.097  RMSE(energy) : 0.094 R^2(energy) : 0.291 R^2(dipole_mags) : 0.200 fitness : 2.4153937021265466 time/s : 41.638443
iter :   15 k_EN_s : 0.040 k_EN_p : 0.055 k_EN_d : -0.056 k_T : 0.175 Mg_s : 1.172 Mg_p : 0.798 Mg_d : 1.557 N_s : 1.073 N_p : 1.093  RMSE(energy) : 0.098 R^2(energy) : 0.247 R^2(dipole_mags) : 0.193 fitness : 2.4615694518578755 time/s : 41.551523
iter :   16 k_EN_s : 0.039 k_EN_p : 0.053 k_EN_d : -0.052 k_T : 0.176 Mg_s : 1.193 Mg_p : 0.848 Mg_d : 1.483 N_s : 1.093 N_p : 1.088  RMSE(energy) : 0.089 R^2(energy) : 0.242 R^2(dipole_mags) : 0.196 fitness : 2.472283863167827 time/s : 48.596666
iter :   17 k_EN_s : 0.037 k_EN_p : 0.055 k_EN_d : -0.053 k_T : 0.186 Mg_s : 1.217 Mg_p : 0.796 Mg_d : 1.575 N_s : 1.088 N_p : 1.091  RMSE(energy) : 0.096 R^2(energy) : 0.247 R^2(dipole_mags) : 0.198 fitness : 2.458660505153094 time/s : 48.558272
iter :   18 k_EN_s : 0.040 k_EN_p : 0.053 k_EN_d : -0.051 k_T : 0.178 Mg_s : 1.162 Mg_p : 0.835 Mg_d : 1.501 N_s : 1.080 N_p : 1.093  RMSE(energy) : 0.090 R^2(energy) : 0.242 R^2(dipole_mags) : 0.197 fitness : 2.470838876078943 time/s : 48.914266
iter :   19 k_EN_s : 0.038 k_EN_p : 0.054 k_EN_d : -0.052 k_T : 0.181 Mg_s : 1.191 Mg_p : 0.784 Mg_d : 1.546 N_s : 1.078 N_p : 1.097  RMSE(energy) : 0.092 R^2(energy) : 0.245 R^2(dipole_mags) : 0.197 fitness : 2.4664910653429386 time/s : 49.068566
iter :   20 k_EN_s : 0.033 k_EN_p : 0.056 k_EN_d : -0.053 k_T : 0.193 Mg_s : 1.259 Mg_p : 0.794 Mg_d : 1.599 N_s : 1.094 N_p : 1.096  RMSE(energy) : 0.100 R^2(energy) : 0.251 R^2(dipole_mags) : 0.198 fitness : 2.4511878448817757 time/s : 48.840460
iter :   21 k_EN_s : 0.038 k_EN_p : 0.053 k_EN_d : -0.052 k_T : 0.179 Mg_s : 1.218 Mg_p : 0.866 Mg_d : 1.495 N_s : 1.050 N_p : 1.100  RMSE(energy) : 0.090 R^2(energy) : 0.244 R^2(dipole_mags) : 0.196 fitness : 2.469704680868773 time/s : 51.991519
iter :   22 k_EN_s : 0.037 k_EN_p : 0.054 k_EN_d : -0.051 k_T : 0.185 Mg_s : 1.232 Mg_p : 0.875 Mg_d : 1.501 N_s : 1.057 N_p : 1.099  RMSE(energy) : 0.092 R^2(energy) : 0.247 R^2(dipole_mags) : 0.198 fitness : 2.4630800042229657 time/s : 48.382387
iter :   23 k_EN_s : 0.036 k_EN_p : 0.055 k_EN_d : -0.046 k_T : 0.183 Mg_s : 1.252 Mg_p : 0.800 Mg_d : 1.424 N_s : 1.133 N_p : 1.091  RMSE(energy) : 0.094 R^2(energy) : 0.249 R^2(dipole_mags) : 0.198 fitness : 2.4597160687301245 time/s : 52.162608
iter :   24 k_EN_s : 0.035 k_EN_p : 0.055 k_EN_d : -0.047 k_T : 0.182 Mg_s : 1.261 Mg_p : 0.842 Mg_d : 1.377 N_s : 1.136 N_p : 1.089  RMSE(energy) : 0.093 R^2(energy) : 0.250 R^2(dipole_mags) : 0.196 fitness : 2.461147577921884 time/s : 52.048033
iter :   25 k_EN_s : 0.041 k_EN_p : 0.053 k_EN_d : -0.051 k_T : 0.176 Mg_s : 1.130 Mg_p : 0.838 Mg_d : 1.496 N_s : 1.036 N_p : 1.103  RMSE(energy) : 0.090 R^2(energy) : 0.242 R^2(dipole_mags) : 0.197 fitness : 2.471578084090741 time/s : 55.955859
iter :   26 k_EN_s : 0.020 k_EN_p : 0.077 k_EN_d : -0.053 k_T : 0.204 Mg_s : 0.962 Mg_p : 0.964 Mg_d : 1.193 N_s : 1.280 N_p : 1.144  RMSE(energy) : 0.216 R^2(energy) : 0.128 R^2(dipole_mags) : 0.010 fitness : 2.64556531936779 time/s : 52.140917
iter :   27 k_EN_s : -1.492 k_EN_p : 1.775 k_EN_d : -0.225 k_T : 2.224 Mg_s : -9.381 Mg_p : 7.911 Mg_d : -18.671 N_s : 19.147 N_p : 3.783  RMSE(energy) : 1258.224 R^2(energy) : 0.006 R^2(dipole_mags) : 0.000 fitness : -1255.2296537115976 time/s : 58.969465
iter :   28 k_EN_s : 0.032 k_EN_p : 0.070 k_EN_d : -0.054 k_T : 0.172 Mg_s : 0.970 Mg_p : 0.817 Mg_d : 1.269 N_s : 1.193 N_p : 1.138  RMSE(energy) : 0.111 R^2(energy) : 0.169 R^2(dipole_mags) : 0.039 fitness : 2.6806692756746804 time/s : 66.022615
iter :   29 k_EN_s : 0.039 k_EN_p : 0.054 k_EN_d : -0.050 k_T : 0.178 Mg_s : 1.153 Mg_p : 0.831 Mg_d : 1.479 N_s : 1.045 N_p : 1.106  RMSE(energy) : 0.090 R^2(energy) : 0.245 R^2(dipole_mags) : 0.196 fitness : 2.469455976038827 time/s : 56.012444
iter :   30 k_EN_s : -1.194 k_EN_p : 1.316 k_EN_d : -0.031 k_T : 1.461 Mg_s : 10.443 Mg_p : -2.697 Mg_d : -6.675 N_s : 8.962 N_p : 3.740  RMSE(energy) : 1080.264 R^2(energy) : 0.004 R^2(dipole_mags) : 0.024 fitness : -1077.2921732399013 time/s : 55.419791

Optimization terminated successfully.
Current function value: 1.600
Iterations: 30
Function evaluations: 414
Gradient evaluations: 30

optimized parameters: {'k_EN_s': 0.043, 'k_EN_p': 0.05, 'k_EN_d': -0.05, 'k_T': 0.173, 'Mg_s': 1.121, 'Mg_p': 0.843, 'Mg_d': 1.505, 'N_s': 1.018, 'N_p': 1.097}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.094 R^2(energy) : 0.271 R^2(dipole_mags) : 0.198 fitness : 1.624525810949975

test set results:
RMSE(energy) : 0.114 R^2(energy) : 0.180 R^2(dipole_mags) : 0.198 fitness : 1.734929571926827


wall-clock time : 1565.778 seconds

#######################


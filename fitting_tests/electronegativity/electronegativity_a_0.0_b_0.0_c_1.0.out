
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:12:34 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 0.8050442905656132 time/s : 3.572040
iter :    1 k_EN_s : -0.195 k_EN_p : 0.873 k_EN_d : 0.093  RMSE(energy) : 85.034 R^2(energy) : 0.006 R^2(dipole_mags) : 0.004 fitness : 0.9963712047215849 time/s : 20.821073
iter :    2 k_EN_s : -0.690 k_EN_p : 6.893 k_EN_d : -0.391  RMSE(energy) : 417.414 R^2(energy) : 0.022 R^2(dipole_mags) : 0.000 fitness : 0.9999970905431376 time/s : 38.538663
iter :    3 k_EN_s : -2.892 k_EN_p : 35.611 k_EN_d : -2.353  RMSE(energy) : 426.385 R^2(energy) : 0.010 R^2(dipole_mags) : 0.047 fitness : 0.9532481707945134 time/s : 52.387222
iter :    4 k_EN_s : -4.177 k_EN_p : 63.739 k_EN_d : -10.548  RMSE(energy) : 437.321 R^2(energy) : 0.009 R^2(dipole_mags) : 0.004 fitness : 0.9963799625795274 time/s : 55.978594
iter :    5 k_EN_s : -0.241 k_EN_p : 0.056 k_EN_d : -0.100  RMSE(energy) : 3.604 R^2(energy) : 0.002 R^2(dipole_mags) : 0.008 fitness : 0.9923372826068996 time/s : 56.211367
iter :    6 k_EN_s : -3.180 k_EN_p : 0.500 k_EN_d : -1.212  RMSE(energy) : 56.962 R^2(energy) : 0.003 R^2(dipole_mags) : 0.006 fitness : 0.9944246065562833 time/s : 24.609848
iter :    7 k_EN_s : -0.035 k_EN_p : 0.013 k_EN_d : -0.017  RMSE(energy) : 2.124 R^2(energy) : 0.032 R^2(dipole_mags) : 0.204 fitness : 0.796124862765134 time/s : 38.276431
iter :    8 k_EN_s : -0.035 k_EN_p : 0.010 k_EN_d : -0.010  RMSE(energy) : 2.558 R^2(energy) : 0.022 R^2(dipole_mags) : 0.209 fitness : 0.7910806786768405 time/s : 20.949932
iter :    9 k_EN_s : -0.036 k_EN_p : 0.008 k_EN_d : -0.004  RMSE(energy) : 2.769 R^2(energy) : 0.016 R^2(dipole_mags) : 0.210 fitness : 0.7904752620337818 time/s : 20.886965
iter :   10 k_EN_s : -0.036 k_EN_p : 0.008 k_EN_d : -0.004  RMSE(energy) : 2.735 R^2(energy) : 0.017 R^2(dipole_mags) : 0.210 fitness : 0.7904532272881456 time/s : 21.025858
iter :   11 k_EN_s : -0.037 k_EN_p : 0.009 k_EN_d : -0.004  RMSE(energy) : 2.640 R^2(energy) : 0.023 R^2(dipole_mags) : 0.210 fitness : 0.7904194429509701 time/s : 21.330906
iter :   12 k_EN_s : -0.038 k_EN_p : 0.008 k_EN_d : -0.004  RMSE(energy) : 2.630 R^2(energy) : 0.024 R^2(dipole_mags) : 0.210 fitness : 0.7904170136179606 time/s : 20.964619
iter :   13 k_EN_s : -0.038 k_EN_p : 0.008 k_EN_d : -0.004  RMSE(energy) : 2.630 R^2(energy) : 0.024 R^2(dipole_mags) : 0.210 fitness : 0.7904163792060842 time/s : 20.931423

Optimization terminated successfully.
Current function value: 0.790
Iterations: 13
Function evaluations: 106
Gradient evaluations: 13

optimized parameters: {'k_EN_s': -0.038, 'k_EN_p': 0.008, 'k_EN_d': -0.004}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 2.647 R^2(energy) : 0.024 R^2(dipole_mags) : 0.210 fitness : 0.7904329262135827

test set results:
RMSE(energy) : 2.637 R^2(energy) : 0.019 R^2(dipole_mags) : 0.213 fitness : 0.7865393521489108


wall-clock time : 440.402 seconds

#######################


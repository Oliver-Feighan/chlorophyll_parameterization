
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 10:13:05 2021

active parameters from python argument input : ['k_EN_s', 'k_EN_p', 'k_EN_d']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 1.0
R^2 (energy): 1.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_EN_s k_EN_p k_EN_d --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 1.0 1.0 1.0 
making optimizer...

running optimization...

iter :    0 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002  RMSE(energy) : 1.261 R^2(energy) : 0.022 R^2(dipole_mags) : 0.195 fitness : 1.5221463587657427 time/s : 3.467423
iter :    1 k_EN_s : 111.024 k_EN_p : 86.908 k_EN_d : 58.339  RMSE(energy) : 1511.444 R^2(energy) : 0.032 R^2(dipole_mags) : 0.044 fitness : -1508.5207692738427 time/s : 20.911332
iter :    2 k_EN_s : 6.833 k_EN_p : -1.022 k_EN_d : -9.131  RMSE(energy) : 53.206 R^2(energy) : 0.016 R^2(dipole_mags) : 0.004 fitness : -50.224799982470934 time/s : 55.712706
iter :    3 k_EN_s : -0.514 k_EN_p : 4.827 k_EN_d : -5.398  RMSE(energy) : 286.876 R^2(energy) : 0.006 R^2(dipole_mags) : 0.002 fitness : -283.88404125774275 time/s : 38.141021
iter :    4 k_EN_s : 0.060 k_EN_p : 0.049 k_EN_d : -0.054  RMSE(energy) : 0.635 R^2(energy) : 0.140 R^2(dipole_mags) : 0.059 fitness : 2.1660597728521953 time/s : 31.478389
iter :    5 k_EN_s : 0.058 k_EN_p : 0.045 k_EN_d : -0.052  RMSE(energy) : 0.585 R^2(energy) : 0.177 R^2(dipole_mags) : 0.113 fitness : 2.1251421104184955 time/s : 24.421478
iter :    6 k_EN_s : 0.048 k_EN_p : 0.047 k_EN_d : -0.075  RMSE(energy) : 0.200 R^2(energy) : 0.133 R^2(dipole_mags) : 0.072 fitness : 2.5945074266358903 time/s : 21.039735
iter :    7 k_EN_s : -0.443 k_EN_p : 0.104 k_EN_d : -1.139  RMSE(energy) : 9.141 R^2(energy) : 0.002 R^2(dipole_mags) : 0.003 fitness : -6.146108554210574 time/s : 20.907732
iter :    8 k_EN_s : 0.034 k_EN_p : 0.048 k_EN_d : -0.072  RMSE(energy) : 0.091 R^2(energy) : 0.092 R^2(dipole_mags) : 0.068 fitness : 2.748914129078929 time/s : 35.063104
iter :    9 k_EN_s : 0.038 k_EN_p : 0.046 k_EN_d : -0.069  RMSE(energy) : 0.089 R^2(energy) : 0.111 R^2(dipole_mags) : 0.095 fitness : 2.7049931846831017 time/s : 20.878038
iter :   10 k_EN_s : 0.039 k_EN_p : 0.044 k_EN_d : -0.066  RMSE(energy) : 0.096 R^2(energy) : 0.115 R^2(dipole_mags) : 0.117 fitness : 2.6712655488212587 time/s : 20.827081
iter :   11 k_EN_s : 0.035 k_EN_p : 0.038 k_EN_d : -0.056  RMSE(energy) : 0.079 R^2(energy) : 0.157 R^2(dipole_mags) : 0.140 fitness : 2.623852609961653 time/s : 20.948436
iter :   12 k_EN_s : 0.033 k_EN_p : 0.036 k_EN_d : -0.052  RMSE(energy) : 0.077 R^2(energy) : 0.161 R^2(dipole_mags) : 0.133 fitness : 2.6293337232469476 time/s : 20.928589
iter :   13 k_EN_s : 0.029 k_EN_p : 0.032 k_EN_d : -0.042  RMSE(energy) : 0.085 R^2(energy) : 0.156 R^2(dipole_mags) : 0.156 fitness : 2.6034538792001722 time/s : 31.330138
iter :   14 k_EN_s : 0.027 k_EN_p : 0.031 k_EN_d : -0.040  RMSE(energy) : 0.077 R^2(energy) : 0.150 R^2(dipole_mags) : 0.158 fitness : 2.613692412018216 time/s : 20.939425
iter :   15 k_EN_s : 0.025 k_EN_p : 0.031 k_EN_d : -0.038  RMSE(energy) : 0.078 R^2(energy) : 0.151 R^2(dipole_mags) : 0.161 fitness : 2.609851280536038 time/s : 20.904428
iter :   16 k_EN_s : 0.004 k_EN_p : 0.023 k_EN_d : -0.006  RMSE(energy) : 0.083 R^2(energy) : 0.169 R^2(dipole_mags) : 0.160 fitness : 2.5879908326381513 time/s : 20.943899
iter :   17 k_EN_s : -0.217 k_EN_p : -0.044 k_EN_d : 0.322  RMSE(energy) : 10.636 R^2(energy) : 0.027 R^2(dipole_mags) : 0.000 fitness : -7.662790361536194 time/s : 20.995767
iter :   18 k_EN_s : -7.409 k_EN_p : -2.251 k_EN_d : 10.996  RMSE(energy) : 60.170 R^2(energy) : 0.003 R^2(dipole_mags) : 0.005 fitness : -57.17841557576549 time/s : 24.793325
iter :   19 k_EN_s : -0.049 k_EN_p : 0.001 k_EN_d : 0.077  RMSE(energy) : 1.067 R^2(energy) : 0.197 R^2(dipole_mags) : 0.121 fitness : 1.6155754007023218 time/s : 42.047788
iter :   20 k_EN_s : -0.101 k_EN_p : -0.030 k_EN_d : 0.165  RMSE(energy) : 2.120 R^2(energy) : 0.051 R^2(dipole_mags) : 0.046 fitness : 0.7833029588528457 time/s : 27.960785
iter :   21 k_EN_s : -0.030 k_EN_p : 0.010 k_EN_d : 0.047  RMSE(energy) : 0.224 R^2(energy) : 0.204 R^2(dipole_mags) : 0.135 fitness : 2.4377886078888644 time/s : 31.584561
iter :   22 k_EN_s : -0.030 k_EN_p : 0.010 k_EN_d : 0.047  RMSE(energy) : 0.222 R^2(energy) : 0.204 R^2(dipole_mags) : 0.135 fitness : 2.4395396676687566 time/s : 31.558999
iter :   23 k_EN_s : -0.039 k_EN_p : 0.005 k_EN_d : 0.061  RMSE(energy) : 0.461 R^2(energy) : 0.192 R^2(dipole_mags) : 0.134 fitness : 2.21282601295566 time/s : 31.545259
iter :   24 k_EN_s : -0.033 k_EN_p : 0.008 k_EN_d : 0.051  RMSE(energy) : 0.273 R^2(energy) : 0.186 R^2(dipole_mags) : 0.141 fitness : 2.399789525004506 time/s : 34.846120
iter :   25 k_EN_s : -0.163 k_EN_p : -0.064 k_EN_d : 0.260  RMSE(energy) : 13.730 R^2(energy) : 0.014 R^2(dipole_mags) : 0.002 fitness : -10.74631731828558 time/s : 31.344147
iter :   26 k_EN_s : -1.870 k_EN_p : -1.024 k_EN_d : 3.003  RMSE(energy) : 88.768 R^2(energy) : 0.000 R^2(dipole_mags) : 0.014 fitness : -85.7820948639009 time/s : 38.321258

Optimization terminated successfully.
Current function value: 1.738
Iterations: 26
Function evaluations: 194
Gradient evaluations: 26

optimized parameters: {'k_EN_s': -0.019, 'k_EN_p': 0.016, 'k_EN_d': 0.029}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 0.107 R^2(energy) : 0.227 R^2(dipole_mags) : 0.142 fitness : 1.7379448637711732

test set results:
RMSE(energy) : 0.120 R^2(energy) : 0.141 R^2(dipole_mags) : 0.197 fitness : 1.7815348642768791


wall-clock time : 792.268 seconds

#######################


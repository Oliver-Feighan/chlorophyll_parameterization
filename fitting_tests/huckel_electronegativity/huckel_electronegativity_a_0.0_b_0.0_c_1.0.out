
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 11:17:17 2021

active parameters from python argument input : ['k_s', 'k_p', 'k_d', 'k_EN_s', 'k_EN_p', 'k_EN_d']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_s k_p k_d k_EN_s k_EN_p k_EN_d --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_s : 2.000 k_p : 2.480 k_d : 2.270 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002  RMSE(energy) : 1.268 R^2(energy) : 0.022 R^2(dipole_mags) : 0.196 fitness : 0.8043875883334088 time/s : 3.547617
iter :    1 k_s : 1.980 k_p : 2.384 k_d : 2.271 k_EN_s : -0.194 k_EN_p : 0.839 k_EN_d : 0.090  RMSE(energy) : 87.653 R^2(energy) : 0.014 R^2(dipole_mags) : 0.002 fitness : 0.9982817423437498 time/s : 31.359895
iter :    2 k_s : 2.049 k_p : 2.479 k_d : 2.533 k_EN_s : -0.733 k_EN_p : 6.916 k_EN_d : -0.091  RMSE(energy) : 430.068 R^2(energy) : 0.006 R^2(dipole_mags) : 0.021 fitness : 0.9788829041652611 time/s : 52.647362
iter :    3 k_s : 1.974 k_p : 2.443 k_d : 2.278 k_EN_s : -0.209 k_EN_p : 0.076 k_EN_d : -0.200  RMSE(energy) : 12.345 R^2(energy) : 0.010 R^2(dipole_mags) : 0.010 fitness : 0.9897314604148093 time/s : 52.096346
iter :    4 k_s : 1.982 k_p : 2.452 k_d : 2.282 k_EN_s : -0.116 k_EN_p : 0.000 k_EN_d : 0.016  RMSE(energy) : 0.998 R^2(energy) : 0.106 R^2(dipole_mags) : 0.169 fitness : 0.8310374707169917 time/s : 38.608169
iter :    5 k_s : 1.626 k_p : 1.665 k_d : 2.767 k_EN_s : -5.323 k_EN_p : -0.510 k_EN_d : 1.377  RMSE(energy) : 56.555 R^2(energy) : 0.003 R^2(dipole_mags) : 0.016 fitness : 0.9837508792458893 time/s : 34.822771
iter :    6 k_s : 1.990 k_p : 2.436 k_d : 2.276 k_EN_s : -0.036 k_EN_p : 0.004 k_EN_d : -0.012  RMSE(energy) : 2.923 R^2(energy) : 0.011 R^2(dipole_mags) : 0.206 fitness : 0.7940055420444037 time/s : 52.432289
iter :    7 k_s : 1.974 k_p : 2.407 k_d : 2.281 k_EN_s : -0.032 k_EN_p : 0.004 k_EN_d : -0.005  RMSE(energy) : 3.303 R^2(energy) : 0.005 R^2(dipole_mags) : 0.210 fitness : 0.7899222653288288 time/s : 34.823016
iter :    8 k_s : 1.816 k_p : 2.062 k_d : 2.326 k_EN_s : -0.011 k_EN_p : -0.001 k_EN_d : -0.018  RMSE(energy) : 5.881 R^2(energy) : 0.002 R^2(dipole_mags) : 0.223 fitness : 0.777199717445622 time/s : 35.076607
iter :    9 k_s : 1.725 k_p : 1.951 k_d : 2.336 k_EN_s : 0.002 k_EN_p : -0.004 k_EN_d : -0.013  RMSE(energy) : 4.768 R^2(energy) : 0.001 R^2(dipole_mags) : 0.228 fitness : 0.7719780492175377 time/s : 31.536726
iter :   10 k_s : 1.552 k_p : 1.954 k_d : 2.330 k_EN_s : 0.005 k_EN_p : -0.003 k_EN_d : 0.013  RMSE(energy) : 1.438 R^2(energy) : 0.123 R^2(dipole_mags) : 0.233 fitness : 0.7665925997735905 time/s : 31.615160
iter :   11 k_s : 1.638 k_p : 1.987 k_d : 2.329 k_EN_s : -0.000 k_EN_p : -0.003 k_EN_d : 0.002  RMSE(energy) : 3.262 R^2(energy) : 0.024 R^2(dipole_mags) : 0.235 fitness : 0.7653468223669876 time/s : 31.599427
iter :   12 k_s : 1.591 k_p : 1.958 k_d : 2.335 k_EN_s : -0.001 k_EN_p : -0.004 k_EN_d : -0.003  RMSE(energy) : 4.092 R^2(energy) : 0.013 R^2(dipole_mags) : 0.236 fitness : 0.7638371681157832 time/s : 31.489851
iter :   13 k_s : 1.565 k_p : 1.979 k_d : 2.334 k_EN_s : -0.003 k_EN_p : -0.005 k_EN_d : -0.001  RMSE(energy) : 4.127 R^2(energy) : 0.011 R^2(dipole_mags) : 0.237 fitness : 0.7630840125135612 time/s : 31.294595
iter :   14 k_s : 1.579 k_p : 2.024 k_d : 2.329 k_EN_s : -0.006 k_EN_p : -0.007 k_EN_d : 0.001  RMSE(energy) : 4.113 R^2(energy) : 0.007 R^2(dipole_mags) : 0.238 fitness : 0.7624846941379364 time/s : 31.389513
iter :   15 k_s : 1.573 k_p : 2.037 k_d : 2.327 k_EN_s : -0.006 k_EN_p : -0.009 k_EN_d : 0.004  RMSE(energy) : 3.972 R^2(energy) : 0.006 R^2(dipole_mags) : 0.238 fitness : 0.7620111355933357 time/s : 31.355447
iter :   16 k_s : 1.572 k_p : 2.043 k_d : 2.328 k_EN_s : -0.009 k_EN_p : -0.013 k_EN_d : 0.007  RMSE(energy) : 3.802 R^2(energy) : 0.006 R^2(dipole_mags) : 0.238 fitness : 0.7616154768518478 time/s : 31.278764
iter :   17 k_s : 1.573 k_p : 2.033 k_d : 2.329 k_EN_s : -0.011 k_EN_p : -0.013 k_EN_d : 0.007  RMSE(energy) : 3.714 R^2(energy) : 0.006 R^2(dipole_mags) : 0.239 fitness : 0.7614556329735556 time/s : 31.322229
iter :   18 k_s : 1.575 k_p : 2.023 k_d : 2.331 k_EN_s : -0.015 k_EN_p : -0.013 k_EN_d : 0.008  RMSE(energy) : 3.483 R^2(energy) : 0.008 R^2(dipole_mags) : 0.239 fitness : 0.7613486410198922 time/s : 31.062525
iter :   19 k_s : 1.573 k_p : 2.019 k_d : 2.331 k_EN_s : -0.015 k_EN_p : -0.013 k_EN_d : 0.008  RMSE(energy) : 3.424 R^2(energy) : 0.009 R^2(dipole_mags) : 0.239 fitness : 0.7613427582688304 time/s : 31.256351
iter :   20 k_s : 1.573 k_p : 2.019 k_d : 2.331 k_EN_s : -0.015 k_EN_p : -0.013 k_EN_d : 0.008  RMSE(energy) : 3.424 R^2(energy) : 0.009 R^2(dipole_mags) : 0.239 fitness : 0.7613427582688304 time/s : 31.138812

Optimization terminated successfully.
Current function value: 0.761
Iterations: 20
Function evaluations: 183
Gradient evaluations: 20

optimized parameters: {'k_s': 1.573, 'k_p': 2.019, 'k_d': 2.331, 'k_EN_s': -0.015, 'k_EN_p': -0.013, 'k_EN_d': 0.008}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 3.489 R^2(energy) : 0.009 R^2(dipole_mags) : 0.239 fitness : 0.7613455480783653

test set results:
RMSE(energy) : 3.448 R^2(energy) : 0.001 R^2(dipole_mags) : 0.203 fitness : 0.7974915062219531


wall-clock time : 732.102 seconds

#######################


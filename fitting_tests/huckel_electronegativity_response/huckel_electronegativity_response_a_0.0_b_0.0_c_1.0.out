
#######################
# BChla-xTB optimizer #
#######################

start time: Wed Apr 21 12:25:29 2021

active parameters from python argument input : ['k_s', 'k_p', 'k_d', 'k_EN_s', 'k_EN_p', 'k_EN_d', 'a_x', 'y_J', 'y_K']

reference data constructed from : "/home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json"

Optimization method : SLSQP
maximum iterations : 5000
weights:
RMSE(energy): 0.0
R^2 (energy): 0.0
R^2 (dipole): 1.0

recreate input with:
python optimizer.py --params k_s k_p k_d k_EN_s k_EN_p k_EN_d a_x y_J y_K --method SLSQP --max_iter 5000 --ref_data /home/of15641/chlorophyll_parameterization/tddft_data/tddft_data.json --run_tests False --weights 0.0 0.0 1.0 
making optimizer...

running optimization...

iter :    0 k_s : 2.000 k_p : 2.480 k_d : 2.270 k_EN_s : 0.006 k_EN_p : -0.001 k_EN_d : -0.002 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.268 R^2(energy) : 0.022 R^2(dipole_mags) : 0.196 fitness : 0.8043875883334088 time/s : 3.512540
iter :    1 k_s : 1.980 k_p : 2.384 k_d : 2.271 k_EN_s : -0.194 k_EN_p : 0.839 k_EN_d : 0.090 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 87.653 R^2(energy) : 0.014 R^2(dipole_mags) : 0.002 fitness : 0.9982817423437498 time/s : 41.984764
iter :    2 k_s : 2.049 k_p : 2.479 k_d : 2.533 k_EN_s : -0.733 k_EN_p : 6.916 k_EN_d : -0.091 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 430.068 R^2(energy) : 0.006 R^2(dipole_mags) : 0.021 fitness : 0.9788829041653838 time/s : 62.937047
iter :    3 k_s : 1.974 k_p : 2.445 k_d : 2.279 k_EN_s : -0.207 k_EN_p : 0.075 k_EN_d : -0.199 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 12.154 R^2(energy) : 0.009 R^2(dipole_mags) : 0.009 fitness : 0.990666741575279 time/s : 63.473491
iter :    4 k_s : 1.983 k_p : 2.446 k_d : 2.282 k_EN_s : -0.120 k_EN_p : -0.000 k_EN_d : 0.015 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 1.000 R^2(energy) : 0.103 R^2(dipole_mags) : 0.168 fitness : 0.8316385475500477 time/s : 49.094813
iter :    5 k_s : 1.685 k_p : 1.659 k_d : 2.740 k_EN_s : -5.158 k_EN_p : -0.471 k_EN_d : 1.234 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 59.804 R^2(energy) : 0.000 R^2(dipole_mags) : 0.070 fitness : 0.9299593569515959 time/s : 45.676602
iter :    6 k_s : 1.989 k_p : 2.436 k_d : 2.276 k_EN_s : -0.036 k_EN_p : 0.005 k_EN_d : -0.011 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 2.872 R^2(energy) : 0.008 R^2(dipole_mags) : 0.206 fitness : 0.7944885328008655 time/s : 62.828774
iter :    7 k_s : 1.969 k_p : 2.400 k_d : 2.281 k_EN_s : -0.033 k_EN_p : 0.005 k_EN_d : -0.006 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.266 R^2(energy) : 0.005 R^2(dipole_mags) : 0.214 fitness : 0.7863727421148652 time/s : 45.241297
iter :    8 k_s : 1.810 k_p : 2.050 k_d : 2.317 k_EN_s : -0.011 k_EN_p : -0.002 k_EN_d : -0.020 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 6.031 R^2(energy) : 0.002 R^2(dipole_mags) : 0.222 fitness : 0.7779156619190937 time/s : 42.040871
iter :    9 k_s : 1.755 k_p : 2.016 k_d : 2.320 k_EN_s : -0.006 k_EN_p : -0.003 k_EN_d : -0.012 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 5.600 R^2(energy) : 0.001 R^2(dipole_mags) : 0.227 fitness : 0.7727601862101146 time/s : 42.302487
iter :   10 k_s : 1.528 k_p : 1.943 k_d : 2.332 k_EN_s : -0.003 k_EN_p : -0.004 k_EN_d : 0.007 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.138 R^2(energy) : 0.045 R^2(dipole_mags) : 0.234 fitness : 0.7664254166255288 time/s : 42.064492
iter :   11 k_s : 1.699 k_p : 2.086 k_d : 2.316 k_EN_s : -0.012 k_EN_p : -0.002 k_EN_d : 0.002 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 4.011 R^2(energy) : 0.004 R^2(dipole_mags) : 0.232 fitness : 0.7675103017560956 time/s : 42.008345
iter :   12 k_s : 1.594 k_p : 1.927 k_d : 2.333 k_EN_s : 0.002 k_EN_p : -0.007 k_EN_d : -0.002 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.903 R^2(energy) : 0.021 R^2(dipole_mags) : 0.236 fitness : 0.7642668546833709 time/s : 45.823827
iter :   13 k_s : 1.589 k_p : 1.987 k_d : 2.328 k_EN_s : -0.004 k_EN_p : -0.006 k_EN_d : 0.002 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.901 R^2(energy) : 0.013 R^2(dipole_mags) : 0.237 fitness : 0.762856260885258 time/s : 45.796069
iter :   14 k_s : 1.558 k_p : 2.019 k_d : 2.329 k_EN_s : -0.005 k_EN_p : -0.010 k_EN_d : 0.004 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.968 R^2(energy) : 0.008 R^2(dipole_mags) : 0.238 fitness : 0.7620728794606173 time/s : 42.177908
iter :   15 k_s : 1.569 k_p : 2.025 k_d : 2.328 k_EN_s : -0.007 k_EN_p : -0.010 k_EN_d : 0.004 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 4.034 R^2(energy) : 0.006 R^2(dipole_mags) : 0.238 fitness : 0.7618174338216819 time/s : 42.020648
iter :   16 k_s : 1.576 k_p : 2.028 k_d : 2.327 k_EN_s : -0.010 k_EN_p : -0.012 k_EN_d : 0.005 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.966 R^2(energy) : 0.005 R^2(dipole_mags) : 0.238 fitness : 0.7615320965037925 time/s : 42.197675
iter :   17 k_s : 1.579 k_p : 2.029 k_d : 2.327 k_EN_s : -0.014 k_EN_p : -0.013 k_EN_d : 0.007 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.653 R^2(energy) : 0.007 R^2(dipole_mags) : 0.239 fitness : 0.7613959313789722 time/s : 41.838968
iter :   18 k_s : 1.577 k_p : 2.027 k_d : 2.328 k_EN_s : -0.015 k_EN_p : -0.013 k_EN_d : 0.008 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.487 R^2(energy) : 0.008 R^2(dipole_mags) : 0.239 fitness : 0.7613595558792762 time/s : 42.416466
iter :   19 k_s : 1.573 k_p : 2.021 k_d : 2.329 k_EN_s : -0.016 k_EN_p : -0.013 k_EN_d : 0.009 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.395 R^2(energy) : 0.009 R^2(dipole_mags) : 0.239 fitness : 0.7613434636044895 time/s : 42.148951
iter :   20 k_s : 1.573 k_p : 2.021 k_d : 2.329 k_EN_s : -0.016 k_EN_p : -0.013 k_EN_d : 0.009 a_x : 0.500 y_J : 4.000 y_K : 2.000  RMSE(energy) : 3.395 R^2(energy) : 0.009 R^2(dipole_mags) : 0.239 fitness : 0.7613434636044895 time/s : 42.204054

Optimization terminated successfully.
Current function value: 0.761
Iterations: 20
Function evaluations: 244
Gradient evaluations: 20

optimized parameters: {'k_s': 1.573, 'k_p': 2.021, 'k_d': 2.329, 'k_EN_s': -0.016, 'k_EN_p': -0.013, 'k_EN_d': 0.009, 'a_x': 0.5, 'y_J': 4.0, 'y_K': 2.0}

running validation...
# of test set samples: 507
training set results:
RMSE(energy) : 3.347 R^2(energy) : 0.010 R^2(dipole_mags) : 0.239 fitness : 0.7613552944698876

test set results:
RMSE(energy) : 3.307 R^2(energy) : 0.001 R^2(dipole_mags) : 0.201 fitness : 0.7985637995978062


wall-clock time : 950.242 seconds

#######################

